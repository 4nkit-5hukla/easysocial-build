import{u as R,al as x,r as t,a as c,j as r,c8 as h,aq as _,a$ as k,c9 as F,W as H}from"./index.2d98d0ad.js";import{B as Y}from"./BizParticipantsProvider.b878d785.js";import{A as u}from"./AllPaymentsApi.fb7f4bb9.js";import{c as o,M as P,D as j}from"./MobileFilter.759541b0.js";import{M as L}from"./MobileHeader.f6327d79.js";import{S as $}from"./ServiceExpiryAlert.477cb5ac.js";import{C as z}from"./Card.684874a8.js";import{C as G}from"./CardContent.619ddd1d.js";import{T as U,a as W,b as q,c as y,d as s,e as J}from"./TableRow.ada42e7f.js";import{L as K}from"./Link.c30ec873.js";import"./Search.26123050.js";import"./Clear.67340fe3.js";import"./RangePopUp.99e60bd1.js";import"./index.eb4aa1c1.js";import"./TextField.6d44061e.js";import"./Select.13473313.js";import"./useFormControl.d9d4270f.js";import"./isMuiElement.3299311e.js";import"./Menu.82d3cc2b.js";import"./List.17d248ed.js";import"./useControlled.a2954169.js";import"./usePickerState.2364e5bb.js";import"./Grid.67e109ad.js";import"./InputAdornment.3ee2d82b.js";import"./StaticDateRangePicker.21a53412.js";import"./PickersToolbarButton.d41261ce.js";import"./LeftArrow.66d21ebf.js";import"./Wrappers.5defd22b.js";const Q=()=>{const{isMobile:f,isTablet:C}=R(),{showSnack:b}=x(),{setErrorMessage:D,setSuccessMessage:I}=x(),[d,E]=t.exports.useState([]),[w,g]=t.exports.useState(""),[N,T]=t.exports.useState(0),[m,v]=t.exports.useState(new Date(new Date().getFullYear(),0,1)),[p,S]=t.exports.useState(new Date(new Date().getFullYear(),11,31)),M=t.exports.useRef(async(e,i,l)=>{e&&e.setHours(0,0,0,0),i&&i.setHours(23,59,59,999);const a=await u.getAllInvoices(e,i,l);if(!a.success)return b(a.message,"error");E(a.payload)});t.exports.useEffect(()=>{M.current(m,p,w)},[m,p,w]);const A=t.exports.useRef(async()=>{const e=await u.getExpiryBusinessCount();if(!e.success)return b(e.message,"error");T(e.payload)});t.exports.useEffect(()=>{A.current()},[]);const B=async(e,i)=>{var l;try{const a=await u.downloadInvoice(e);if(a){const O=window.URL.createObjectURL(new Blob([a])),n=document.createElement("a");n.href=O,n.setAttribute("download",`${i}.pdf`),document.body.appendChild(n),n.style.display="none",n.click(),(l=n==null?void 0:n.parentNode)==null||l.removeChild(n),I("Report Downloaded")}else throw new Error("Internal Server Error")}catch(a){D(a.message)}};return c(t.exports.Fragment,{children:[f&&r(L,{title:"Invoices"}),r("div",{className:o.ContentInner,children:c("div",{className:o.InnerWrapper,children:[d.length>0&&f&&r(P,{placeholder:"Search Invoice No.",setSearch:e=>g(e),from:m,to:p,setStartDate:e=>v(e),setEndDate:e=>S(e)}),N>0&&r($,{noOfBusi:N}),r(z,{elevation:0,className:o.Card,children:c(G,{className:o.CardContent,children:[d.length>0&&C&&r(j,{title:"Invoices",placeholder:"Search Invoice No.",setSearch:e=>g(e),from:m,to:p,setStartDate:e=>v(e),setEndDate:e=>S(e)}),d.length>0?r("div",{className:o.TableOuter,children:r(U,{className:o.TableContainer,children:c(W,{children:[r(q,{children:c(y,{className:o.TableHead,children:[r(s,{component:"th",children:"Date"}),r(s,{component:"th",children:"Inv No."}),r(s,{component:"th",children:"Order No."}),r(s,{component:"th",children:"Amount"}),r(s,{component:"th",children:"Download"})]})}),r(J,{children:d&&d.map(e=>{let i="";e.order_array.forEach(a=>{i+=h(a)+", "});const l=h(e.invoice_number);return r(_,{children:c(y,{children:[r(s,{className:o.OrderDate,children:k(e.created_at).format("D MMM YYYY")}),r(s,{children:h(e.invoice_number)}),r(s,{children:i.replace(/,(?=\s*$)/,"")}),c(s,{className:o.OrderDate,children:[e.currency==="INR"?"\u20B9":"$",F(Number(e.billing_amount.payable_amount))]}),r(s,{children:c(K,{component:"button",underline:"none",className:"report-download",onClick:()=>B(e.id,l),children:[r("img",{src:"/static/images/svg/download.svg",alt:"download"}),r("span",{className:"ms-1",children:"Download"})]})})]})})})})]})})}):r("div",{className:o.NoData,children:"No invoice available."})]})})]})})]})},De=()=>c(t.exports.Fragment,{children:[r(H,{children:r("title",{children:"Invoices"})}),r(Y,{children:r(Q,{})})]});export{De as default};
