import{a as t,j as e,$ as Y,r as o,a6 as s,as as se,at as re,au as ae,aL as B,av as le,e as ie,aM as ce,u as ee,aF as de,W as he,a0 as pe,d as ue}from"./index.b186592b.js";import{W as T}from"./WAUsageApi.c3f61109.js";import{L as ge}from"./LeftArrow.b5872852.js";import{L as me}from"./LinkPlatForm.808d5195.js";import{W as Ce,a as U,b as K}from"./WhatsApp.00540be5.js";import{l as G,m as j,C as $,N as xe,O as H,Q as A,R as fe,T as M,U as N,V as we,G as be,W as Q,v as Fe,X as Me,Y as O,Z as V,_ as I,$ as Z,a0 as z,a1 as J,n as Se,H as Re,o as ye,p as ve,q as ke}from"./Tags.f9f8608f.js";import{C as X}from"./Card.f9953836.js";import{C as _}from"./CardContent.fa9b6571.js";import{A as Le}from"./CommonComponents.ab047aaf.js";import{L as Be}from"./PickersToolbarButton.f63b1315.js";import{M as Te,D as De}from"./DatePicker.02111701.js";import{T as Ee}from"./TextField.7cfd5f8b.js";import{T as Ue,a as We,b as Ye,c as S,d as a,e as P}from"./TableRow.55399933.js";import{L as W}from"./Link.7de60bb3.js";import{R as He}from"./RangePopUp.00608d1a.js";import"./withStyles.e8acb61c.js";import"./MenuItem.46f15d95.js";import"./List.1f5dafa3.js";import"./listItemTextClasses.846cbc39.js";import"./ListItem.40de5bfa.js";import"./listItemButtonClasses.0f0ff00e.js";import"./isMuiElement.9a08466c.js";import"./ArrowRight.e7fea676.js";import"./Styles.5fa2ae96.js";import"./Grid.96fe2808.js";import"./useControlled.ec723b61.js";import"./InputAdornment.fe191e21.js";import"./Select.9835b57c.js";import"./Menu.a1c4ed55.js";import"./Popper.079befca.js";import"./StaticDateRangePicker.60fade55.js";const Ae=()=>t("svg",{className:"icon",width:"23",height:"23",viewBox:"0 0 23 23",fill:"none",xmlns:"//www.w3.org/2000/svg",children:[e("circle",{cx:"11.5",cy:"11.5",r:"11.5",fill:"#B0E9FF"}),e("path",{d:"M10.3076 10.0218C10.5826 10.0218 10.8056 9.79887 10.8056 9.52382V8.89302C10.8056 8.61801 10.5826 8.39502 10.3076 8.39502C10.0325 8.39502 9.80957 8.61798 9.80957 8.89302V9.52382C9.80957 9.79887 10.0326 10.0218 10.3076 10.0218Z",fill:"#FFFFFF"}),e("path",{d:"M12.167 10.0218C12.442 10.0218 12.665 9.79887 12.665 9.52382V8.89302C12.665 8.61801 12.442 8.39502 12.167 8.39502C11.8919 8.39502 11.6689 8.61798 11.6689 8.89302V9.52382C11.6689 9.79887 11.8919 10.0218 12.167 10.0218Z",fill:"#FFFFFF"}),e("path",{d:"M10.3076 12.8768C10.5826 12.8768 10.8056 12.6538 10.8056 12.3788V11.748C10.8056 11.473 10.5826 11.25 10.3076 11.25C10.0325 11.25 9.80957 11.473 9.80957 11.748V12.3788C9.80957 12.6538 10.0326 12.8768 10.3076 12.8768Z",fill:"#FFFFFF"}),e("path",{d:"M12.167 12.8768C12.442 12.8768 12.665 12.6538 12.665 12.3788V11.748C12.665 11.473 12.442 11.25 12.167 11.25C11.8919 11.25 11.6689 11.473 11.6689 11.748V12.3788C11.6689 12.6538 11.8919 12.8768 12.167 12.8768Z",fill:"#FFFFFF"}),e("path",{d:"M15.7476 16.0855C13.6731 16.0855 17.2129 16.0855 14.3495 16.0855V6.49801C14.3495 6.22299 14.1265 6 13.8515 6H8.62277C8.34775 6 8.12476 6.22296 8.12476 6.49801V16.0855C4.71899 16.0855 9.89447 16.0855 6.49801 16.0855C6.22296 16.0855 6 16.3085 6 16.5835C6 16.8586 6.22296 17.0815 6.49801 17.0815H8.6228H13.8515H15.7476C16.0226 17.0815 16.2456 16.8586 16.2456 16.5835C16.2456 16.3085 16.0226 16.0855 15.7476 16.0855ZM11.7218 16.0855H10.8024V15.1661H11.7218V16.0855ZM13.3535 16.0855H12.7178V14.6681C12.7178 14.3931 12.4948 14.1701 12.2198 14.1701H10.3044C10.0294 14.1701 9.80638 14.3931 9.80638 14.6681V16.0855H9.1208V6.99601H13.3535L13.3535 16.0855Z",fill:"#FFFFFF"})]}),Ne=()=>t("svg",{className:"icon",width:"23",height:"23",viewBox:"0 0 23 23",fill:"none",xmlns:"//www.w3.org/2000/svg",children:[e("circle",{cx:"11.5",cy:"11.5",r:"11.5",fill:"#B0E9FF"}),e("path",{d:"M11.6525 11.5217C12.9011 11.5217 13.9133 10.5095 13.9133 9.26087C13.9133 8.01223 12.9011 7 11.6525 7C10.4038 7 9.3916 8.01223 9.3916 9.26087C9.3916 10.5095 10.4038 11.5217 11.6525 11.5217Z",stroke:"#FFFFFF",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),e("path",{d:"M8 14.9997C8 13.2606 9.3913 11.5215 11.6522 11.5215C13.913 11.5215 15.3043 13.2606 15.3043 14.9997",stroke:"#FFFFFF",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Oe=()=>t("svg",{className:"icon",width:"23",height:"23",viewBox:"0 0 23 23",fill:"none",xmlns:"//www.w3.org/2000/svg",children:[e("circle",{cx:"11.5",cy:"11.5",r:"11.5",fill:"#B0E9FF"}),e("path",{d:"M10.3111 10.3669L10.3117 8.48321C10.3117 8.28781 10.1941 8.11161 10.0136 8.03682C9.83313 7.96204 9.62527 8.00326 9.48703 8.1414L7.14159 10.4856C6.95289 10.6743 6.95279 10.9801 7.14139 11.1688L9.48562 13.5143C9.57802 13.6068 9.70166 13.656 9.8274 13.656C9.88962 13.656 9.95233 13.6439 10.012 13.6192C10.1926 13.5445 10.3103 13.3684 10.3104 13.173L10.3109 11.3382C12.4041 11.5783 14.0352 13.3606 14.0352 15.517C14.0352 15.7839 14.2515 16.0002 14.5183 16.0002C14.7851 16.0002 15.0014 15.7839 15.0014 15.517C15.0014 12.8275 12.938 10.6111 10.3111 10.3669Z",fill:"#FFFFFF"})]}),Ve=({loadingStatus:p})=>{const{setErrorMessage:m}=Y(),[l,d]=o.exports.useState(),[r,i]=o.exports.useState(),[c,h]=o.exports.useState(),g=()=>l?t(M,{children:[t("svg",{width:"11",height:"11",viewBox:"0 0 11 11",fill:"none",xmlns:"//www.w3.org/2000/svg",children:[e("circle",{cx:"5.5",cy:"5.5",r:.5+l.size,fill:l.statusColor}),e("circle",{cx:"5.5",cy:"5.5",r:"5",stroke:"#B9B9B9"})]}),e(N,{children:l.name})]}):e(M,{children:e(s,{width:58})}),w=()=>c?t(M,{children:[c.health==="GREEN"&&e("svg",{width:"14",height:"12",viewBox:"0 0 14 12",fill:"none",xmlns:"//www.w3.org/2000/svg",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.0134 3.10551L4.11073 11.2663L0.767578 6.44966L3.2321 4.73908L4.61622 6.73324L10.9863 0.894043L13.0134 3.10551Z",fill:c.statusColor})}),e(N,{children:c.status})]}):e(M,{children:e(s,{width:55})}),R=()=>r?t(M,{children:[r.status==="connected"?e("svg",{width:"14",height:"12",viewBox:"0 0 14 12",fill:"none",xmlns:"//www.w3.org/2000/svg",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.0134 3.10551L4.11073 11.2663L0.767578 6.44966L3.2321 4.73908L4.61622 6.73324L10.9863 0.894043L13.0134 3.10551Z",fill:r.statusColor})}):t("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"//www.w3.org/2000/svg",children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.62882 1.98772L2.62882 9.98772L0.371094 8.01221L7.37109 0.012207L9.62882 1.98772Z",fill:r.statusColor}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.371176 1.98772L7.37118 9.98772L9.62891 8.01221L2.62891 0.012207L0.371176 1.98772Z",fill:r.statusColor})]}),e(N,{children:r.status==="connected"?"Connected":"Not Connected"})]}):e(M,{children:e(s,{width:88})}),b=o.exports.useCallback(async()=>{try{const C=await T.getWaHealthReport();if(!C.success)throw Error(C.message);const{account_status:n,health:x}=C.payload;switch(d(Ce.TIER1),x){case"GREY":h(U.GREY);break;case"RED":h(U.RED);break;case"ORANGE":h(U.ORANGE);break;case"GREEN":h(U.GREEN);break}switch(n){case"connected":i(K.Connected);break;default:i(K.NotConnected);break}}catch(C){m(C.message)}},[]);return o.exports.useEffect(()=>{b()},[b]),e(X,{elevation:0,sx:{...G,"& .MuiCardContent-root":{pb:"10px !important"}},children:t(_,{sx:j,children:[e($,{children:p?e(s,{width:90}):"Live Status"}),t(xe,{sx:{justifyContent:{lg:"center"},margin:{xs:"-20px -36px 20px",sm:"-20px -20px 0"},padding:{xs:"20px 36px",sm:"20px"}},children:[t(H,{statusColor:l==null?void 0:l.statusColor,children:[e(A,{children:"Messaging Tier"}),e(g,{})]}),t(H,{statusColor:c==null?void 0:c.statusColor,children:[e(A,{children:"WhatsApp Health"}),e(w,{})]}),t(H,{statusColor:r==null?void 0:r.statusColor,children:[e(A,{children:"Account Status"}),e(R,{})]})]}),e(fe,{children:l?l.message:e(s,{width:"95%"})})]})})},Ie=({open:p,closeDialog:m,downloadReport:l,downloading:d,setDownloading:r})=>{const[i,c]=o.exports.useState(null);return t(se,{open:p,onClose:m,children:[e(re,{children:"Select Month"}),e(ae,{sx:{pt:"20px !important"},children:e(Be,{dateAdapter:Te,children:e(De,{views:["year","month"],openTo:"year",label:"Year and Month",minDate:new Date("2021-01-01"),maxDate:new Date,value:i,onChange:h=>{c(h)},renderInput:({inputProps:h,...g})=>e(Ee,{...g,helperText:null,inputProps:{...h,...i?{value:B(i).local().format("MMM YYYY")}:{}},autoComplete:"off"})})})}),e(le,{children:e(ie,{disabled:d,onClick:()=>{r(!0),l(B(i).local().format("YYYY-MM"))},children:"Download"})})]})},Ze=({loadingStatus:p})=>{const{setErrorMessage:m,setSuccessMessage:l}=Y(),[d,r]=o.exports.useState(!1),[i,c]=o.exports.useState(!1),[h,g]=o.exports.useState(!0),[w,R]=o.exports.useState([]),b=async n=>{var x;try{const F=await T.downloadWaMonthWiseReport({month:n});if(F){const y=new Date(n),D=window.URL.createObjectURL(new Blob([F])),u=document.createElement("a");u.href=D,u.setAttribute("download",`SessionReport_${y.toLocaleString("en-us",{month:"short"})}_${y.getFullYear()}.pdf`),document.body.appendChild(u),u.style.display="none",u.click(),(x=u==null?void 0:u.parentNode)==null||x.removeChild(u),l("Report Downloaded")}else throw new Error("Internal Server Error")}catch(F){m(F.message)}finally{c(!1)}},C=o.exports.useCallback(async()=>{try{const n=await T.getWaMonthlyReport();if(!n.success)throw Error(n.message);R(n.payload),g(!1)}catch(n){m(n.message)}},[]);return o.exports.useEffect(()=>{C()},[C]),t(o.exports.Fragment,{children:[e(X,{elevation:0,sx:G,children:t(_,{sx:j,children:[e($,{children:p?e(s,{width:214}):"Monthly Utilization Report"}),e(Ue,{children:t(We,{"aria-label":"Monthly Report",className:"reports",sx:{"& .MuiTableCell-root":{borderBottom:"none",color:"#3B414A",fontSize:"14px",lineHeight:"16px"},"& .MuiLink-root":{alignItems:"center",color:"#32C5FF",display:"inline-flex",fontSize:"14px",fontWeight:500,lineHeight:"16px"},"& .MuiTableHead-root":{"& .MuiTableCell-root":{fontWeight:700,opacity:.7,padding:{xs:"0 0 14px",sm:"8px"}}},"& .MuiTableBody-root":{"& .MuiTableRow-root":{"&.MuiTableRow-hover":{"&:hover":{backgroundColor:"transparent","& .MuiTableCell-root":{backgroundColor:"#C4C4C433","&:first-of-type":{borderRadius:"10px 0 0 10px"},"&:last-of-type":{borderRadius:"0 10px 10px 0"}}}},"& .MuiTableCell-root":{borderBottom:"none",fontWeight:400,height:"32px",opacity:.9,"&:not(.loading)":{padding:0},"&:last-of-type":{"& .MuiSkeleton-root":{backgroundColor:"#32C5FF80"}},"& .MuiSkeleton-root":{backgroundColor:"#3B414A",margin:"0 auto"}}}}},children:[e(Ye,{children:t(S,{children:[e(a,{align:"center",children:"Duration"}),t(a,{align:"center",children:["Customer",e("br",{}),"Initiated Sessions"]}),t(a,{align:"center",children:["Business",e("br",{}),"Initiated Sessions"]}),e(a,{align:"center",children:"Report"})]})}),h?t(P,{children:[t(S,{sx:{"&:last-of-type td, &:last-of-type th":{border:0}},hover:!0,children:[e(a,{align:"center",children:e(s,{width:60})}),e(a,{align:"center",children:e(s,{width:24})}),e(a,{align:"center",children:e(s,{width:24})}),e(a,{align:"center",children:e(s,{width:74})})]}),t(S,{sx:{"&:last-of-type td, &:last-of-type th":{border:0}},hover:!0,children:[e(a,{align:"center",children:e(s,{width:60})}),e(a,{align:"center",children:e(s,{width:24})}),e(a,{align:"center",children:e(s,{width:24})}),e(a,{align:"center",children:e(s,{width:74})})]}),t(S,{sx:{"&:last-of-type td, &:last-of-type th":{border:0}},hover:!0,children:[e(a,{align:"center",children:e(s,{width:60})}),e(a,{align:"center",children:e(s,{width:24})}),e(a,{align:"center",children:e(s,{width:24})}),e(a,{align:"center",children:e(s,{width:74})})]})]}):w&&w.length===0?e(P,{children:e(S,{children:e(a,{colSpan:4,align:"center",children:"No Reports Available"})})}):e(P,{children:w&&w.map((n,x)=>t(S,{sx:{"&:last-of-type td, &:last-of-type th":{border:0}},hover:!0,children:[e(a,{align:"center",children:ce(n.month)}),e(a,{align:"center",children:n.cis}),e(a,{align:"center",children:n.bis}),e(a,{align:"center",children:t(W,{component:"button",underline:"none",className:"report-download",onClick:()=>b(n.month),children:[e("img",{src:"/static/images/svg/download.svg",alt:"download"}),e("span",{className:"ms-1",children:"Download"})]})})]},x))})]})}),e(Le,{sx:{my:2.5},children:h?e(s,{width:180,sx:{backgroundColor:"#32C5FF80"}}):e(W,{component:"button",underline:"none",sx:{color:"#32C5FF",fontSize:16,fontWeight:600,lineHeight:1.1875},onClick:()=>c(!0),children:"Download older reports"})})]})}),e(Ie,{open:i,closeDialog:()=>{c(!1)},downloading:d,setDownloading:r,downloadReport:b})]})};var te=(p=>(p.TODAY="TODAY",p.CUSTOM="CUSTOM",p))(te||{});const ze=({loadingStatus:p})=>{const{isMobile:m}=ee(),{setErrorMessage:l}=Y(),{TODAY:d,CUSTOM:r}=te,[i,c]=o.exports.useState(!0),[h,g]=o.exports.useState(0),[w,R]=o.exports.useState(0),[b,C]=o.exports.useState(0),[n,x]=o.exports.useState(d),[F,y]=o.exports.useState(!1),[D,u]=o.exports.useState([null,null]),[v,k]=D,oe=()=>{u([null,null]),y(!0),setTimeout(()=>{console.clear()},100)},ne=f=>{x(f==="escapeKeyDown"||f==="backdropClick"?d:r),y(!1)},q=o.exports.useCallback(async()=>{try{const f=n===r&&v?v:n===d?new Date:null,E=n===r&&k?k:n===d?new Date:null;if(f&&f.setHours(0,0,0,0),E&&E.setHours(23,59,59,999),f&&E){c(!0);const L=await T.getRangeUtilization(f,E);if(!L.success)throw Error(L.message);g(L.payload.cis),R(L.payload.bis),C(L.payload.replyRate)}}catch(f){l(f.message)}finally{c(!1)}},[n,v,k]);return o.exports.useEffect(()=>{q()},[q]),t(o.exports.Fragment,{children:[e(X,{elevation:0,sx:G,children:t(_,{sx:j,children:[t(we,{sx:{mb:{xs:1.875,sm:3.75}},children:[t(be,{sx:{alignItems:"baseline",display:"flex",flexDirection:{xs:"column",lg:"row"},gap:.625},children:[e($,{sx:{mb:0},children:p?e(s,{width:90}):"Utilization"}),n==="TODAY"&&e(Q,{children:B().format("Do MMM YYYY")}),n==="CUSTOM"&&v&&k&&t(Q,{children:[B(v).format("Do MMM YYYY")," to ",B(k).format("Do MMM YYYY")]})]}),t(Fe,{sx:{display:"flex",alignItems:"center",gap:1.75},children:[e(W,{component:"button",underline:"none",onClick:()=>{x(d),u([null,null])},sx:{color:"#82858B",fontSize:12,fontWeight:500,lineHeight:"12px",borderBottom:n===d?"2px solid #12B0EE":"2px solid transparent"},children:"TODAY"}),e(W,{className:`change-period ${n==="CUSTOM"?"active":""}`,component:"button",underline:"none",onClick:()=>oe(),sx:{color:"#82858B",fontSize:12,fontWeight:500,lineHeight:"12px",borderBottom:n===r?"2px solid #12B0EE":"2px solid transparent"},children:"CUSTOM"})]})]}),t(Me,{sx:{py:{xs:0,sm:2.5},px:{xs:2.5},mt:{lg:-2.5},mx:{lg:-2.5},flexDirection:{xs:"column",lg:"row"}},children:[t(O,{children:[t(V,{children:[e(I,{children:"Customer Initiated Sessions"}),e(Ne,{})]}),t(Z,{children:[e(z,{children:i?e(s,{}):h}),e(J,{children:i?e(s,{}):"Sessions"})]})]}),t(O,{children:[t(V,{children:[e(I,{children:"Business Initiated Sessions"}),e(Ae,{})]}),t(Z,{children:[e(z,{children:i?e(s,{}):w}),e(J,{children:i?e(s,{}):"Sessions"})]})]}),t(O,{children:[t(V,{children:[e(I,{children:"Business Initiated Sessions - Reply %"}),e(Oe,{})]}),e(Z,{children:e(z,{children:i?e(s,{}):b})})]})]})]})}),e(He,{open:F,closeDialog:ne,range:D,setRange:u,wrapper:m?"mobile":"desktop"})]})},Pe=()=>{const{isMobile:p}=ee(),{showSnack:m}=Y(),{platformExist:l}=de(),[d,r]=o.exports.useState(!0),[i,c]=o.exports.useState(!1),h=o.exports.useRef(async()=>{if(typeof l=="boolean"&&l){const g=await T.getWaStatus();if(!g.success)return r(!1),m(g.message,"error");c(g.success),r(!1)}else r(!1)});return o.exports.useEffect(()=>{h.current()},[]),t(o.exports.Fragment,{children:[e(he,{children:e("title",{children:"Usage and Reports"})}),p&&t(Se,{children:[e(pe,{component:ue,to:"/business-settings",className:"icon-md-button",children:e(ge,{})}),e(Re,{children:"Usage and Reports"})]}),e(ye,{children:t(ve,{sx:ke,children:[!i&&!d&&typeof l=="boolean"&&l===!1&&e(me,{}),i&&e(Ve,{loadingStatus:d}),i&&e(ze,{loadingStatus:d}),i&&e(Ze,{loadingStatus:d})]})})]})},Mt=()=>e(Pe,{});export{Mt as default};
