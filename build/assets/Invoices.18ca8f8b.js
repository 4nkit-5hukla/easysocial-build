import{u as R,al as S,r as t,a as n,j as r,c8 as h,aq as _,a$ as k,c9 as F,W as H}from"./index.ece9aff6.js";import{B as Y}from"./BizParticipantsProvider.3e611df5.js";import{A as u}from"./AllPaymentsApi.6cb98a67.js";import{c as s,M as P,D as j}from"./MobileFilter.2c6b5099.js";import{M as L}from"./MobileHeader.52114ba3.js";import{S as $}from"./ServiceExpiryAlert.00666696.js";import{C as z}from"./Card.f4c87cf9.js";import{C as G}from"./CardContent.0f5272a0.js";import{T as U,a as W,b as q,c as x,d as a,e as J}from"./TableRow.f43f61b2.js";import{L as K}from"./Link.5f576aff.js";import"./Search.81b477b2.js";import"./Clear.aebe021f.js";import"./Divider.5e9a60f5.js";import"./dividerClasses.be26840c.js";import"./RangePopUp.aea74439.js";import"./index.eb4aa1c1.js";import"./TextField.a574cfa5.js";import"./Select.03464598.js";import"./useFormControl.d2abdcc0.js";import"./isMuiElement.80cc5cad.js";import"./Menu.41d358f2.js";import"./List.c81063c5.js";import"./useControlled.1f67ff79.js";import"./usePickerState.fb9075d4.js";import"./Grid.2edd9a40.js";import"./InputAdornment.6310bdb0.js";import"./StaticDateRangePicker.5c31ae7c.js";import"./PickersToolbarButton.82dc0411.js";import"./LeftArrow.be0f8108.js";import"./Wrappers.be76913d.js";import"./Wrappers.module.1d569f64.js";const Q=()=>{const{isMobile:f,isTablet:C}=R(),{showSnack:b}=S(),{setErrorMessage:D,setSuccessMessage:I}=S(),[p,T]=t.exports.useState([]),[w,g]=t.exports.useState(""),[N,E]=t.exports.useState(0),[d,v]=t.exports.useState(new Date(new Date().getFullYear(),0,1)),[m,y]=t.exports.useState(new Date(new Date().getFullYear(),11,31)),M=t.exports.useRef(async(e,i,l)=>{e&&e.setHours(0,0,0,0),i&&i.setHours(23,59,59,999);const o=await u.getAllInvoices(e,i,l);if(!o.success)return b(o.message,"error");T(o.payload)});t.exports.useEffect(()=>{M.current(d,m,w)},[d,m,w]);const A=t.exports.useRef(async()=>{const e=await u.getExpiryBusinessCount();if(!e.success)return b(e.message,"error");E(e.payload)});t.exports.useEffect(()=>{A.current()},[]);const B=async(e,i)=>{var l;try{const o=await u.downloadInvoice(e);if(o){const O=window.URL.createObjectURL(new Blob([o])),c=document.createElement("a");c.href=O,c.setAttribute("download",`${i}.pdf`),document.body.appendChild(c),c.style.display="none",c.click(),(l=c==null?void 0:c.parentNode)==null||l.removeChild(c),I("Report Downloaded")}else throw new Error("Internal Server Error")}catch(o){D(o.message)}};return n(t.exports.Fragment,{children:[f&&r(L,{title:"Invoices"}),r("div",{className:s.ContentInner,children:n("div",{className:s.InnerWrapper,children:[f&&r(P,{placeholder:"Search Invoice No.",setSearch:e=>g(e),from:d,to:m,setStartDate:e=>v(e),setEndDate:e=>y(e)}),N>0&&r($,{noOfBusi:N}),n(z,{elevation:0,className:s.Card,children:[C&&r(j,{title:"Invoices",placeholder:"Search Invoice No.",setSearch:e=>g(e),from:d,to:m,setStartDate:e=>v(e),setEndDate:e=>y(e)}),r(G,{className:s.CardContent,children:p.length>0?r("div",{className:s.TableOuter,children:r(U,{className:s.TableContainer,children:n(W,{children:[r(q,{children:n(x,{className:s.TableHead,children:[r(a,{component:"th",children:"Date"}),r(a,{component:"th",children:"Inv No."}),r(a,{component:"th",children:"Order No."}),r(a,{component:"th",children:"Amount"}),r(a,{component:"th",children:"Download"})]})}),r(J,{children:p&&p.map(e=>{let i="";e.order_array.forEach(o=>{i+=h(o)+", "});const l=h(e.invoice_number);return r(_,{children:n(x,{children:[r(a,{className:s.OrderDate,children:k(e.created_at).format("D MMM YYYY")}),r(a,{children:h(e.invoice_number)}),r(a,{children:i.replace(/,(?=\s*$)/,"")}),n(a,{className:s.OrderDate,children:[e.currency==="INR"?"\u20B9":"$",F(Number(e.billing_amount.payable_amount))]}),r(a,{children:n(K,{component:"button",underline:"none",className:"report-download",onClick:()=>B(e.id,l),children:[r("img",{src:"/static/images/svg/download.svg",alt:"download"}),r("span",{className:"ms-1",children:"Download"})]})})]})})})})]})})}):n("div",{className:s.NoData,children:["There is no invoice to show for this duration.",r("br",{}),"Try to select a different date range."]})})]})]})})]})},Ee=()=>n(t.exports.Fragment,{children:[r(H,{children:r("title",{children:"Invoices"})}),r(Y,{children:r(Q,{})})]});export{Ee as default};
