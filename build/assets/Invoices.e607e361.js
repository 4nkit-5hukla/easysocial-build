import{u as R,al as C,r as t,a as c,j as r,c8 as p,aq as _,a$ as k,c9 as F,W as H}from"./index.fd4ae6d6.js";import{B as Y}from"./BizParticipantsProvider.2cf7f9ec.js";import{A as h}from"./AllPaymentsApi.4db865d6.js";import{M as P,c as n,a as j,D as L}from"./MobileFilter.6b9e1c45.js";import{S as $}from"./ServiceExpiryAlert.c2bd7a33.js";import{C as z}from"./Card.e09e37ac.js";import{C as G}from"./CardContent.f0d0982c.js";import{T as U,a as W,b as q,c as N,d as a,e as J}from"./TableRow.341d482f.js";import{L as K}from"./Link.a6e40fc7.js";import"./Search.fff4ba2f.js";import"./Clear.c355970a.js";import"./LeftArrow.5ec3afba.js";import"./Wrappers.39eb0e5b.js";import"./RangePopUp.0f2fd6b3.js";import"./index.eb4aa1c1.js";import"./TextField.fa193343.js";import"./Select.96b8ae4e.js";import"./useFormControl.13400fe7.js";import"./isMuiElement.8b92655b.js";import"./Menu.c4bc1234.js";import"./List.bc505dcb.js";import"./useControlled.9f1cf0dd.js";import"./usePickerState.d9e8de5d.js";import"./Grid.d62f6b2b.js";import"./InputAdornment.57d392ca.js";import"./StaticDateRangePicker.e23446e4.js";import"./PickersToolbarButton.42ba6889.js";const Q=()=>{const{isMobile:u,isTablet:v}=R(),{showSnack:f}=C(),{setErrorMessage:D,setSuccessMessage:I}=C(),[b,E]=t.exports.useState([]),[w,S]=t.exports.useState(""),[g,T]=t.exports.useState(0),[d,x]=t.exports.useState(new Date(new Date().getFullYear(),0,1)),[m,y]=t.exports.useState(new Date(new Date().getFullYear(),11,31)),M=t.exports.useRef(async(e,i,l)=>{e&&e.setHours(0,0,0,0),i&&i.setHours(23,59,59,999);const s=await h.getAllInvoices(e,i,l);if(!s.success)return f(s.message,"error");E(s.payload)});t.exports.useEffect(()=>{M.current(d,m,w)},[d,m,w]);const A=t.exports.useRef(async()=>{const e=await h.getExpiryBusinessCount();if(!e.success)return f(e.message,"error");T(e.payload)});t.exports.useEffect(()=>{A.current()},[]);const B=async(e,i)=>{var l;try{const s=await h.downloadInvoice(e);if(s){const O=window.URL.createObjectURL(new Blob([s])),o=document.createElement("a");o.href=O,o.setAttribute("download",`${i}.pdf`),document.body.appendChild(o),o.style.display="none",o.click(),(l=o==null?void 0:o.parentNode)==null||l.removeChild(o),I("Report Downloaded")}else throw new Error("Internal Server Error")}catch(s){D(s.message)}};return c(t.exports.Fragment,{children:[u&&r(P,{title:"Invoices"}),r("div",{className:n.ContentInner,children:c("div",{className:n.InnerWrapper,children:[u&&r(j,{placeholder:"Search Invoice No.",setSearch:e=>S(e),from:d,to:m,setStartDate:e=>x(e),setEndDate:e=>y(e)}),g>0&&r($,{noOfBusi:g}),r(z,{elevation:0,className:n.Card,children:c(G,{className:n.CardContent,children:[v&&r(L,{title:"Invoices",placeholder:"Search Invoice No.",setSearch:e=>S(e),from:d,to:m,setStartDate:e=>x(e),setEndDate:e=>y(e)}),r("div",{className:n.TableOuter,children:r(U,{className:n.TableContainer,children:c(W,{children:[r(q,{children:c(N,{className:n.TableHead,children:[r(a,{component:"th",children:"Date"}),r(a,{component:"th",children:"Inv No."}),r(a,{component:"th",children:"Order No."}),r(a,{component:"th",children:"Amount"}),r(a,{component:"th",children:"Download"})]})}),r(J,{children:b&&b.map(e=>{let i="";e.order_array.forEach(s=>{i+=p(s)+", "});const l=p(e.invoice_number);return r(_,{children:c(N,{children:[r(a,{className:n.OrderDate,children:k(e.created_at).format("D MMM YYYY")}),r(a,{children:p(e.invoice_number)}),r(a,{children:i.replace(/,(?=\s*$)/,"")}),c(a,{className:n.OrderDate,children:[e.currency==="INR"?"\u20B9":"$",F(Number(e.billing_amount.payable_amount))]}),r(a,{children:c(K,{component:"button",underline:"none",className:"report-download",onClick:()=>B(e.id,l),children:[r("img",{src:"/static/images/svg/download.svg",alt:"download"}),r("span",{className:"ms-1",children:"Download"})]})})]})})})})]})})})]})})]})})]})},ve=()=>c(t.exports.Fragment,{children:[r(H,{children:r("title",{children:"Invoices"})}),r(Y,{children:r(Q,{})})]});export{ve as default};
