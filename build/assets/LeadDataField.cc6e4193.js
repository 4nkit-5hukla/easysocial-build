import{r as o,a,j as e,W as O,L as X}from"./index.40731ccf.js";import{L}from"./LeadDataFieldsApi.3e9ced86.js";import{a as z}from"./Global.df2e642b.js";import{u as I}from"./SnackProvider.c23b45d0.js";import{u as k,a as M}from"./LeadDataFieldsProvider.8979e7cb.js";import{L as H}from"./LeftArrow.f0eb0d15.js";import{S as _}from"./Search.7932f6b8.js";import{c as S,D as V,d as j,e as q,f as P,F as G,G as K,g as C,b as U}from"./CommonComponents.2907f096.js";import{L as $}from"./ListItem.470bc43f.js";import{a as J,L as Q}from"./ListItemText.dd66d6c2.js";import{I as x}from"./IconButton.32052684.js";import{M as Y}from"./MoreVert.521b3f8a.js";import{M as Z}from"./Menu.c8609563.js";import{M as D}from"./MenuItem.993e792e.js";import{D as ee,a as ae,b as te}from"./DialogContent.09e0d138.js";import{D as re}from"./DialogTitle.478ec786.js";import{B as v}from"./Button.23e9af97.js";import{T as ie,A as le,D as se,E as oe,I as ne,J as de,K as B,L as A,M as W,w as ce,v as N,Z as me,m as pe,N as he,H as ue,n as fe,O as ge,P as xe,Q as ye,q as Fe,r as De,R as be,U as Ce,V as we,X as Le,Y as _e}from"./Tags.8173da82.js";import{C as R}from"./Clear.45f1d488.js";import{C as Se,u as Te,F as T}from"./FormTextField.e8a8d831.js";import{i as Ie}from"./index.78496bd8.js";import{F as E}from"./FormIOSSwitch.f22a97f2.js";import{A as ke}from"./Autocomplete.51aa6def.js";import{T as ve}from"./TextField.5c68a002.js";import{D as Ne}from"./Drawer.aaa0e533.js";import{C as Ee}from"./Card.7abb454b.js";import{C as Me}from"./CardContent.5ff8b118.js";import{D as He}from"./Divider.67fd8281.js";import"./Axios.d864dcf9.js";import"./useEnhancedEffect.687c8d79.js";import"./styled.d8987ece.js";import"./ButtonBase.5b7c04ce.js";import"./styled.0e116553.js";import"./Typography.6cce9393.js";import"./listItemButtonClasses.8ac37410.js";import"./isMuiElement.70284bb2.js";import"./Modal.765cd3a5.js";import"./useId.009d26ce.js";import"./Switch.ac05e708.js";import"./SwitchBase.e6b6f36a.js";import"./Select.993207b0.js";import"./Close.7a8b0835.js";import"./Popper.bd20b39c.js";import"./Chip.fa9f5c2d.js";const Be=({display_name:n,field_name:d,field_type:m,id:p})=>{const{setErrorMessage:s,setSuccessMessage:l}=I(),{setEditLeadDataId:h,setShowLeadDataForm:u}=k(),[c,f]=o.exports.useState(null),[w,y]=o.exports.useState(!1),g=()=>{y(!0)},b=()=>{y(!1)},F=i=>{f(i.currentTarget)},r=()=>{f(null)},t=async()=>{try{const i=await L.deleteLeadDataField(p);if(!i.success)throw Error(i.message);l(i.message),setTimeout(()=>window.location.reload(),1e3)}catch(i){s(i.message)}finally{b()}};return a(o.exports.Fragment,{children:[a($,{component:"div",sx:{px:{xs:0,md:2}},children:[e(J,{primary:a("div",{className:"primary-block",children:[e("h2",{className:"list-title",children:n}),e("h2",{className:"type",children:m==="string"?"Text":m})]}),secondary:`[${d}]`,sx:{"& .primary-block":{alignItems:"center",display:"flex",flexWrap:"wrap",gap:1.25,marginBottom:.75,"& .list-title":{color:"text.primary",fontSize:15,fontWeight:500,lineHeight:"18px"},"& .type":{color:"#767676b3",fontSize:12,fontWeight:400,lineHeight:1,textTransform:"uppercase"}},"& .MuiListItemText-secondary":{color:"text.primary",fontSize:12,maxWidth:290,fontWeight:400,lineHeight:"15px"}}}),e(Q,{children:e(x,{onClick:F,children:e(Y,{})})})]}),Boolean(c)&&a(Z,{anchorEl:c,open:Boolean(c),onClose:r,keepMounted:!0,MenuListProps:{"aria-labelledby":"Options"},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPaper-root":{minWidth:120}},children:[e(D,{onClick:()=>{h(p),u(!0),r()},children:"Edit"}),e(D,{onClick:()=>{g(),r()},children:"Delete"})]}),a(ee,{open:w,"aria-labelledby":"responsive-dialog-title",children:[e(re,{id:"responsive-dialog-title",children:"Delete"}),e(ae,{children:"Are you sure you want to delete?"}),a(te,{children:[e(v,{color:"secondary",onClick:()=>{b()},children:"Cancel"}),e(v,{onClick:async()=>{await t()},autoFocus:!0,children:"Delete"})]})]})]})},Ae=({isSearchActive:n,setSearchActive:d})=>{const{setLeadDataFilter:m,setShowLeadDataForm:p}=k();return a(ie,{children:[e(le,{children:e(S,{disableIcon:!0,type:"button",onClick:()=>p(!0),sx:{py:0,px:.625,height:36,mt:0},children:"New Lead Data Field"})}),a(se,{children:[!n&&e(oe,{children:e(ne,{children:"Lead Data Fields"})}),a(de,{children:[n&&e(B,{children:a(A,{children:[e(x,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:e(_,{})}),e(W,{onChange:({target:{value:s}})=>m(s),placeholder:"Search Field"}),e(x,{onClick:()=>{m(""),d(!n)},sx:{position:"absolute",right:0,top:0},children:e(R,{})})]})}),!n&&e(x,{onClick:()=>d(s=>!s),children:e(_,{})})]})]})]})},We=({control:n,defaultValue:d,rules:m,name:p,children:s,setValue:l,...h})=>e(Se,{rules:m,control:n,name:p,render:({field:u})=>e(ke,{multiple:!0,options:d,onChange:(c,f)=>{l(u.name,f)},freeSolo:!0,renderInput:c=>e(ve,{...c,variant:"filled",label:h.label,sx:h.sx})})}),Re=({open:n,closeDrawer:d})=>{const{setErrorMessage:m,setSuccessMessage:p}=I(),{editLeadDataId:s}=M(),{control:l,handleSubmit:h,watch:u,reset:c,setValue:f}=Te({defaultValues:{field_type:"",display_name:"",field_name:"",display_in_filter:!1,use_lead_title:!1}}),{field_type:w,display_name:y,field_options:g}=u(),b=async t=>{try{if(console.log(t),s){const i=await L.updateLeadDataField(s,t);if(!i.success)throw Error(i.message);p(i.message),setTimeout(()=>window.location.reload(),1e3)}else{const i=await L.createLeadDataField(t);if(!i.success)throw Error(i.message);p(i.message),setTimeout(()=>window.location.reload(),1e3)}}catch(i){m(i.message)}finally{d()}},F=o.exports.useCallback(()=>f("field_name",y.toLowerCase().replaceAll(" ","_")),[y]),r=o.exports.useCallback(async()=>{try{if(s){const t=await L.getLeadDataField(s);if(!t.success)throw Error(t.message);c({field_type:t.payload.field_type,display_name:t.payload.display_name,field_name:t.payload.field_name,display_in_filter:t.payload.display_in_filter,use_lead_title:t.payload.mark_as_lead_title,field_options:t.payload.field_options?t.payload.field_options:[]})}}catch(t){console.error(t.message)}},[s]);return o.exports.useEffect(()=>{F()},[F]),o.exports.useEffect(()=>{r()},[r]),e(Ne,{anchor:"right",open:n,onClose:(t,i)=>!Ie(i)&&d(),sx:{zIndex:"modal"},children:a(V,{sx:{width:{xs:"100vw",md:360}},children:[a(j,{children:[e(x,{onClick:d,sx:{width:32,height:32},children:e(H,{})}),e(q,{children:`${s?"Edit":"Create a"} Data Field`})]}),a(P,{onSubmit:h(b),children:[e(G,{children:a(K,{children:[e(C,{children:a(T,{select:!0,control:l,label:"Data Field Type",name:"field_type",sx:ce,required:!0,defaultValue:w,children:[e(D,{value:"",disabled:!0,children:"Select Data Field Type"}),e(D,{value:"numeric",children:"Number"}),e(D,{value:"string",children:"Text"}),e(D,{value:"boolean",children:"Boolean"}),e(D,{value:"date",children:"Date"})]})}),e(C,{children:e(T,{control:l,name:"display_name",label:"Display Name",placeholder:"Display Name",required:!0,sx:N})}),e(C,{children:e(T,{control:l,name:"field_name",label:"Field Name",placeholder:"Field Name",required:!0,sx:N})}),e(C,{children:e(We,{control:l,setValue:f,defaultValue:g!=null?g:[],name:"field_options",label:"Options",sx:me})}),e(C,{children:a("div",{className:"d-flex justify-content-between",children:[a("div",{className:"grow",children:[e("h5",{className:"field-title",children:"Display Field in Filters & Analytics?"}),e("small",{className:"field-subtitle",children:"This field will be displayed in filter option and analytics can be drawn on this field."})]}),e(E,{control:l,name:"display_in_filter"})]})}),e(C,{children:a("div",{className:"d-flex justify-content-between",children:[a("div",{className:"grow",children:[e("h5",{className:"field-title",children:"Use as Lead Title"}),e("small",{className:"field-subtitle",children:"If a value is available in the field it will show as the default title instead of the phone number in the Chat section."})]}),e(E,{control:l,name:"use_lead_title"})]})})]})}),e(U,{children:e(S,{type:"submit",children:"Save"})})]})]})})},Oe=()=>{const{isMobile:n,isTablet:d}=z(),{setErrorMessage:m}=I(),[p,s]=o.exports.useState(!0),[l,h]=o.exports.useState(!1),{leadDataFields:u,leadDataFilter:c,showLeadDataForm:f}=M(),{setLeadDataFields:w,setLeadDataFilter:y,setShowLeadDataForm:g,setEditLeadDataId:b}=k(),F=o.exports.useCallback(async()=>{try{const r=await L.getLeadDataFields();if(!r.success)throw Error(r.message);w(r.payload),s(!1)}catch(r){m(r.message)}},[]);return o.exports.useEffect(()=>{F()},[F]),a(o.exports.Fragment,{children:[e(O,{children:e("title",{children:"Lead Data Fields"})}),n&&a(pe,{sx:he,children:[!l&&e(x,{component:X,to:"/business-settings",sx:{width:32,height:32},children:e(H,{})}),!l&&e(ue,{children:"Lead Data Fields"}),l&&e(B,{children:a(A,{children:[e(x,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:e(_,{})}),e(W,{onChange:({target:{value:r}})=>y(r),placeholder:"Search Field"}),e(x,{onClick:()=>{y(""),h(!l)},sx:{position:"absolute",right:0,top:0},children:e(R,{})})]})}),!l&&u.length>0&&e(x,{onClick:()=>h(r=>!r),children:e(_,{})})]}),e(fe,{sx:ge,children:e(xe,{sx:ye,children:!p&&e(Ee,{elevation:0,sx:Fe,children:e(Me,{sx:De,children:u.length===0?a(be,{children:[e(Ce,{children:e(S,{disableIcon:!0,onClick:()=>g(!0),sx:{borderRadius:2,boxShadow:"0px 8px 8px rgba(50, 197, 255, 0.1)",fontSize:16,fontWeight:700,height:36,lineHeight:"19px",margin:"auto",textTransform:"capitalize"},children:"New Lead Data Field"})}),e(we,{children:e(Le,{children:"Lead Data Field creates an input field for your user, where the value input by a user can be stored and be later retrieved for different users to draw an analytical comparison or as a future reference."})})]}):a(o.exports.Fragment,{children:[d&&e(Ae,{isSearchActive:l,setSearchActive:h}),d&&e(He,{}),u.filter(r=>{var t;return(t=r==null?void 0:r.display_name)==null?void 0:t.toLowerCase().includes(c==null?void 0:c.toLowerCase())}).reverse().map((r,t)=>e(Be,{...r},t))]})})})})}),n&&u.length>0&&e(_e,{children:e(S,{onClick:()=>g(!0),variant:"outlined",color:"primary",disableIcon:!0,children:"New Lead Data Field"})}),e(Re,{open:f,closeDrawer:()=>{b(void 0),g(!1)}})]})},va=()=>e(o.exports.Fragment,{children:e(Oe,{})});export{va as default};
