import{u as X,Z as g,r as t,a as n,j as r,c6 as m,as as N,aY as Y,c7 as _,W as k}from"./index.a8b2df7b.js";import{B as F}from"./BizParticipantsProvider.b20170db.js";import{A as p,M as H,a as j,D as L}from"./DeskHeader.f205eab8.js";import{g as P,I as W,T as $}from"./Tags.0cb2a8a8.js";import{C as z,I as G,a as U,b as Z,T as q,c as J,d as K,O as y}from"./Styles.6343e2a9.js";import{S as Q}from"./ServiceExpiryAlert.b5149b95.js";import{C as V}from"./Card.bd9c7588.js";import{C as ee}from"./CardContent.da5f0df4.js";import{T as re,a as te,b as se,c as D,d as o,e as oe}from"./TableRow.8990a2cb.js";import{L as ae}from"./Link.59aaed31.js";import"./LeftArrow.a1fcfefa.js";import"./Search.b56f4801.js";import"./Clear.30a48954.js";import"./RangePopUp.a3e1f399.js";import"./index.eb4aa1c1.js";import"./TextField.f1851448.js";import"./Select.a83a6cc9.js";import"./isMuiElement.42abfbfb.js";import"./Menu.58d7bdb3.js";import"./List.e9d0b826.js";import"./useControlled.e7b8947c.js";import"./usePickerState.50d91eeb.js";import"./Grid.599f3dbe.js";import"./InputAdornment.b97a990b.js";import"./StaticDateRangePicker.7b2d6f25.js";import"./PickersToolbarButton.527dc5a1.js";import"./withStyles.7c05d18e.js";import"./ListItem.912ff118.js";import"./listItemButtonClasses.07cb6408.js";import"./styled.3f21e940.js";const ne=()=>{const{isMobile:u,isTablet:I}=X(),{showSnack:h}=g(),{setErrorMessage:T,setSuccessMessage:v}=g(),[f,E]=t.exports.useState([]),[x,b]=t.exports.useState(""),[S,B]=t.exports.useState(0),[l,w]=t.exports.useState(new Date(new Date().getFullYear(),0,1)),[d,C]=t.exports.useState(new Date(new Date().getFullYear(),11,31)),M=t.exports.useRef(async(e,i,c)=>{e&&e.setHours(0,0,0,0),i&&i.setHours(23,59,59,999);const s=await p.getAllInvoices(e,i,c);if(!s.success)return h(s.message,"error");E(s.payload)});t.exports.useEffect(()=>{M.current(l,d,x)},[l,d,x]);const O=t.exports.useRef(async()=>{const e=await p.getExpiryBusinessCount();if(!e.success)return h(e.message,"error");B(e.payload)});t.exports.useEffect(()=>{O.current()},[]);const A=async(e,i)=>{var c;try{const s=await p.downloadInvoice(e);if(s){const R=window.URL.createObjectURL(new Blob([s])),a=document.createElement("a");a.href=R,a.setAttribute("download",`${i}.pdf`),document.body.appendChild(a),a.style.display="none",a.click(),(c=a==null?void 0:a.parentNode)==null||c.removeChild(a),v("Report Downloaded")}else throw new Error("Internal Server Error")}catch(s){T(s.message)}};return n(t.exports.Fragment,{children:[u&&r(H,{title:"Invoices"}),r(P,{sx:z,children:n(W,{sx:G,children:[u&&r(j,{setSearch:e=>b(e),from:l,to:d,setStartDate:e=>w(e),setEndDate:e=>C(e)}),S>0&&r(Q,{noOfBusi:S}),r(V,{elevation:0,sx:U,children:n(ee,{sx:Z,children:[I&&r(L,{title:"Invoices",setSearch:e=>b(e),from:l,to:d,setStartDate:e=>w(e),setEndDate:e=>C(e)}),r($,{sx:q,children:r(re,{sx:J,children:n(te,{children:[r(se,{children:n(D,{sx:K,children:[r(o,{component:"th",children:"Date"}),r(o,{component:"th",children:"Inv No."}),r(o,{component:"th",children:"Order No."}),r(o,{component:"th",children:"Amount"}),r(o,{component:"th",children:"Download"})]})}),r(oe,{children:f&&f.map(e=>{let i="";e.order_array.forEach(s=>{i+=m(s)+", "});const c=m(e.invoice_number);return r(N,{children:n(D,{children:[r(o,{sx:y,children:Y(e.created_at).format("D MMM YYYY")}),r(o,{children:m(e.invoice_number)}),r(o,{children:i.replace(/,(?=\s*$)/,"")}),n(o,{sx:y,children:[e.currency==="INR"?"\u20B9":"$",_(e.billing_amount.payable_amount)]}),r(o,{children:n(ae,{component:"button",underline:"none",className:"report-download",onClick:()=>A(e.id,c),children:[r("img",{src:"/static/images/svg/download.svg",alt:"download"}),r("span",{className:"ms-1",children:"Download"})]})})]})})})})]})})})]})})]})})]})},ke=()=>n(t.exports.Fragment,{children:[r(k,{children:r("title",{children:"Invoices"})}),r(F,{children:r(ne,{})})]});export{ke as default};
