import{u as R,ai as g,r as t,a as n,j as r,c9 as m,as as X,aV as _,ca as k,W as F}from"./index.0fc63d4e.js";import{B as H}from"./BizParticipantsProvider.8f5d6b17.js";import{A as p}from"./AllPaymentsApi.138dd04a.js";import{g as Y,I as P,T as j}from"./Tags.6a703ad0.js";import{C as L,I as W,a as $,b as z,T as G,c as U,d as V,O as y}from"./Styles.623f0960.js";import{S as q}from"./ServiceExpiryAlert.5101e1d4.js";import{M as J,a as K,D as Q}from"./DeskHeader.1ed01a47.js";import{C as Z}from"./Card.8962761a.js";import{C as ee}from"./CardContent.b2f0281d.js";import{T as re,a as te,b as oe,c as I,d as s,e as se}from"./TableRow.dca495ce.js";import{L as ae}from"./Link.e8430bfc.js";import"./withStyles.54d4ccd0.js";import"./ListItem.6d0b39ca.js";import"./List.d46fa225.js";import"./listItemButtonClasses.9bb2654b.js";import"./isMuiElement.eba0df62.js";import"./styled.9b77f846.js";import"./LeftArrow.6537b7c2.js";import"./Search.882e17bb.js";import"./Clear.9e3d331a.js";import"./RangePopUp.61bf24ef.js";import"./index.eb4aa1c1.js";import"./TextField.dfa21b7c.js";import"./Select.7c32bfe7.js";import"./useFormControl.777b9f12.js";import"./Menu.e1eaa76e.js";import"./useControlled.8b48121e.js";import"./usePickerState.68438f35.js";import"./Grid.ac4525dd.js";import"./InputAdornment.f981dc0b.js";import"./StaticDateRangePicker.5c0f44f3.js";import"./PickersToolbarButton.d97e7aac.js";const ne=()=>{const{isMobile:h,isTablet:D}=R(),{showSnack:u}=g(),{setErrorMessage:v,setSuccessMessage:T}=g(),[f,E]=t.exports.useState([]),[x,S]=t.exports.useState(""),[b,N]=t.exports.useState(0),[l,w]=t.exports.useState(new Date(new Date().getFullYear(),0,1)),[d,C]=t.exports.useState(new Date(new Date().getFullYear(),11,31)),B=t.exports.useRef(async(e,i,c)=>{e&&e.setHours(0,0,0,0),i&&i.setHours(23,59,59,999);const o=await p.getAllInvoices(e,i,c);if(!o.success)return u(o.message,"error");E(o.payload)});t.exports.useEffect(()=>{B.current(l,d,x)},[l,d,x]);const M=t.exports.useRef(async()=>{const e=await p.getExpiryBusinessCount();if(!e.success)return u(e.message,"error");N(e.payload)});t.exports.useEffect(()=>{M.current()},[]);const O=async(e,i)=>{var c;try{const o=await p.downloadInvoice(e);if(o){const A=window.URL.createObjectURL(new Blob([o])),a=document.createElement("a");a.href=A,a.setAttribute("download",`${i}.pdf`),document.body.appendChild(a),a.style.display="none",a.click(),(c=a==null?void 0:a.parentNode)==null||c.removeChild(a),T("Report Downloaded")}else throw new Error("Internal Server Error")}catch(o){v(o.message)}};return n(t.exports.Fragment,{children:[h&&r(J,{title:"Invoices"}),r(Y,{sx:L,children:n(P,{sx:W,children:[h&&r(K,{placeholder:"Search Invoice No.",setSearch:e=>S(e),from:l,to:d,setStartDate:e=>w(e),setEndDate:e=>C(e)}),b>0&&r(q,{noOfBusi:b}),r(Z,{elevation:0,sx:$,children:n(ee,{sx:z,children:[D&&r(Q,{title:"Invoices",placeholder:"Search Invoice No.",setSearch:e=>S(e),from:l,to:d,setStartDate:e=>w(e),setEndDate:e=>C(e)}),r(j,{sx:G,children:r(re,{sx:U,children:n(te,{children:[r(oe,{children:n(I,{sx:V,children:[r(s,{component:"th",children:"Date"}),r(s,{component:"th",children:"Inv No."}),r(s,{component:"th",children:"Order No."}),r(s,{component:"th",children:"Amount"}),r(s,{component:"th",children:"Download"})]})}),r(se,{children:f&&f.map(e=>{let i="";e.order_array.forEach(o=>{i+=m(o)+", "});const c=m(e.invoice_number);return r(X,{children:n(I,{children:[r(s,{sx:y,children:_(e.created_at).format("D MMM YYYY")}),r(s,{children:m(e.invoice_number)}),r(s,{children:i.replace(/,(?=\s*$)/,"")}),n(s,{sx:y,children:[e.currency==="INR"?"\u20B9":"$",k(Number(e.billing_amount.payable_amount))]}),r(s,{children:n(ae,{component:"button",underline:"none",className:"report-download",onClick:()=>O(e.id,c),children:[r("img",{src:"/static/images/svg/download.svg",alt:"download"}),r("span",{className:"ms-1",children:"Download"})]})})]})})})})]})})})]})})]})})]})},Ye=()=>n(t.exports.Fragment,{children:[r(F,{children:r("title",{children:"Invoices"})}),r(H,{children:r(ne,{})})]});export{Ye as default};
