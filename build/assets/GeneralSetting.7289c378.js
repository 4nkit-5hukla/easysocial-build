var I=Object.defineProperty;var V=(a,s,n)=>s in a?I(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n;var m=(a,s,n)=>(V(a,typeof s!="symbol"?s+"":s,n),n);import{ai as b,aj as j,r,ak as h,u as k,Z as B,al as F,am as N,a as p,j as t,a0 as O,L as Z,an as y,W as H}from"./index.cd52f8cd.js";import{u as q}from"./index.esm.8afa557f.js";import{L as U}from"./LeftArrow.7516ff67.js";import{c as $,H as K,d as W,e as J}from"./Wrappers.d08a6477.js";import{C as _}from"./Card.314c5e08.js";import{A as Q,a as X}from"./Form.208637ba.js";import{p as S}from"./Position.module.ff7b7fa6.js";import"./Card.bfb1684a.js";import"./CardContent.04d49bbc.js";import"./ArrowRight.11b8e5be.js";class i{}m(i,"getGeneralSettings",async()=>await b("/business","GET")),m(i,"putGeneralSettings",async(s,n)=>await b(`/business/${s}`,"PUT",{data:n})),m(i,"getCountryProvinces",async s=>await j(`/countries/${s}.json`,"GET"));const Y=r.exports.lazy(()=>h(()=>import("./BusinessDetails.645f3700.js"),["assets/BusinessDetails.645f3700.js","assets/mui-tel-input.es.762908c6.js","assets/index.cd52f8cd.js","assets/index.6e2e3c06.css","assets/ListItemIcon.b25e5a6b.js","assets/listItemTextClasses.d61b6850.js","assets/List.199f3c38.js","assets/ListItemText.bf0149ab.js","assets/TextField.ce8adeda.js","assets/Select.130218e1.js","assets/isMuiElement.d0445487.js","assets/Menu.b01b41b0.js","assets/useControlled.68258d97.js","assets/InputAdornment.e22a3329.js","assets/MenuItem.57ef0a8f.js","assets/FormTextField.bc7e3af6.js","assets/index.esm.8afa557f.js","assets/FileUpload.178bbaee.js","assets/index.7aa7608c.js","assets/AssetsApi.ea078454.js","assets/FileUpload.a55168fb.css","assets/Tags.fb462e9d.js","assets/withStyles.3aaf2704.js","assets/ListItem.de41e53c.js","assets/listItemButtonClasses.b240ef45.js","assets/Grid.ded1e6b1.js","assets/Grid.6523dca6.css","assets/Form.208637ba.js","assets/ArrowRight.11b8e5be.js","assets/Form.22a18028.css","assets/Card.314c5e08.js","assets/Card.bfb1684a.js","assets/CardContent.04d49bbc.js","assets/Card.fb089c80.css","assets/Style.d96d560c.js"])),ee=r.exports.lazy(()=>h(()=>import("./BusinessAddress.aa357971.js"),["assets/BusinessAddress.aa357971.js","assets/index.cd52f8cd.js","assets/index.6e2e3c06.css","assets/FormTextField.bc7e3af6.js","assets/index.esm.8afa557f.js","assets/TextField.ce8adeda.js","assets/Select.130218e1.js","assets/isMuiElement.d0445487.js","assets/Menu.b01b41b0.js","assets/List.199f3c38.js","assets/useControlled.68258d97.js","assets/Tags.fb462e9d.js","assets/withStyles.3aaf2704.js","assets/MenuItem.57ef0a8f.js","assets/listItemTextClasses.d61b6850.js","assets/ListItem.de41e53c.js","assets/listItemButtonClasses.b240ef45.js","assets/Grid.ded1e6b1.js","assets/Grid.6523dca6.css","assets/Form.208637ba.js","assets/ArrowRight.11b8e5be.js","assets/Form.22a18028.css","assets/Card.314c5e08.js","assets/Card.bfb1684a.js","assets/CardContent.04d49bbc.js","assets/Card.fb089c80.css","assets/Style.d96d560c.js"])),te=r.exports.lazy(()=>h(()=>import("./BusinessLocation.6fceb6fd.js"),["assets/BusinessLocation.6fceb6fd.js","assets/index.cd52f8cd.js","assets/index.6e2e3c06.css","assets/FormTextField.bc7e3af6.js","assets/index.esm.8afa557f.js","assets/TextField.ce8adeda.js","assets/Select.130218e1.js","assets/isMuiElement.d0445487.js","assets/Menu.b01b41b0.js","assets/List.199f3c38.js","assets/useControlled.68258d97.js","assets/ListItem.de41e53c.js","assets/listItemButtonClasses.b240ef45.js","assets/ListItemText.bf0149ab.js","assets/listItemTextClasses.d61b6850.js","assets/Search.d6bc75d5.js","assets/index.f3d48750.js","assets/Tags.fb462e9d.js","assets/withStyles.3aaf2704.js","assets/MenuItem.57ef0a8f.js","assets/Grid.ded1e6b1.js","assets/Grid.6523dca6.css","assets/Form.208637ba.js","assets/ArrowRight.11b8e5be.js","assets/Form.22a18028.css","assets/Styles.3fefcec0.js","assets/Card.bfb1684a.js","assets/CardContent.04d49bbc.js","assets/BusinessLocation.30a18e82.css"])),se=()=>{const{isMobile:a}=k(),{setErrorMessage:s,setSuccessMessage:n}=B(),{timeZoneList:x}=F(),{setProvinces:w}=N(),[E,v]=r.exports.useState(!0),[L,G]=r.exports.useState(Math.random()),{control:f,handleSubmit:A,watch:d,reset:C,setValue:c}=q({defaultValues:{business_name:"",mobile_number:"",industry:"",website:"",logo:"",address:"",city:"",state:"",country:"",pin_code:"",latitude:20.5937,longitude:78.9629,timezone:{label:"(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi",value:5.5}}}),{country:g,timezone:u}=d(),P=e=>{c("address",typeof e.address=="function"?e.address():e.address),c("latitude",typeof e.lat=="function"?e.lat():e.lat),c("longitude",typeof e.lng=="function"?e.lng():e.lng)},T=async e=>{try{const{id:l,mobile_number:D}=e,o=await i.putGeneralSettings(l,{...e,number:D,timezoneLabel:u.label,timezoneValue:u.value});if(o.errors)throw Error(o.errors.pop().message);if(!o.success&&o.message)throw Error(o.message);n(o.message),G(Math.random())}catch(l){s(l.message)}},z=r.exports.useRef(async()=>{try{const e=await i.getGeneralSettings();if(e.errors)throw Error(e.errors.pop().message);if(!e.success)throw Error(e.message);C(e.payload),v(!1)}catch(e){s(e.message)}}),R=r.exports.useRef(async()=>{const e=await i.getCountryProvinces(g);w(e)}),M=r.exports.useRef(async()=>{const[e]=x.filter(({label:l})=>l===u.label);e&&c("timezone.value",parseFloat(e.value))});return r.exports.useEffect(()=>{u.value&&M.current()},[u.value]),r.exports.useEffect(()=>{g&&R.current()},[g]),r.exports.useEffect(()=>{z.current()},[L]),p(r.exports.Fragment,{children:[a&&p($,{children:[t(O,{component:Z,to:"/business-settings",className:"icon-md-button",children:t(U,{})}),t(K,{children:"General Settings"})]}),E?t(_,{className:S.AbsCenter,children:t(y,{height:72,width:72})}):t(r.exports.Suspense,{fallback:t(_,{className:S.AbsCenter,children:t(y,{height:72,width:72})}),children:t(W,{children:p(J,{onSubmit:A(T),children:[t(Y,{control:f,watch:d,setValue:c}),t(ee,{control:f,watch:d}),t(te,{control:f,watch:d,updatePlace:P}),t(Q,{children:t(X,{type:"submit",children:"Save"})})]})})})]})},fe=()=>p(r.exports.Fragment,{children:[t(H,{children:t("title",{children:"General Settings"})}),t(se,{})]});export{fe as default};
