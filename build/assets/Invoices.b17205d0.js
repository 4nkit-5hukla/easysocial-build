import{u as M,aj as y,c9 as A,r as i,a as s,j as e,ca as p,ae as B,b0 as R,cb as O,W as _}from"./index.7f82941f.js";import{B as k}from"./BizParticipantsProvider.5c0743ae.js";import{A as h}from"./AllPaymentsApi.9cf85212.js";import{c as t,M as P,D as j}from"./MobileFilter.c86cd5a2.js";import{M as F}from"./MobileHeader.7d1e818b.js";import{S as H}from"./ServiceExpiryAlert.21b4b258.js";import{C as L}from"./Card.273c3e06.js";import{C as Y}from"./CardContent.f8f32f32.js";import{T as $,a as z,b as G,c as N,d as a,e as U}from"./TableRow.ccf6afd5.js";import{L as W}from"./Link.fbef9aee.js";import"./Search.21aa4e31.js";import"./Clear.6f7c24d8.js";import"./Divider.6de19a4b.js";import"./dividerClasses.ea04d24b.js";import"./CommonComponents.123cce4d.js";import"./ArrowRight.7cb9a070.js";import"./Styles.c059562f.js";import"./styled.00f71db4.js";import"./Stack.14a8c174.js";import"./index.esm.c1ac109e.js";import"./TextField.bc8832bf.js";import"./Select.460c2a9d.js";import"./useFormControl.95a504f2.js";import"./isMuiElement.ea3f4046.js";import"./Menu.22af6717.js";import"./List.771b1df1.js";import"./useControlled.15b67f87.js";import"./Check.eb9c5dde.js";import"./usePickerState.6c8ad4c5.js";import"./Grid.8af03d83.js";import"./InputAdornment.1fb89a13.js";import"./StaticDateRangePicker.1b0d65d6.js";import"./PickersToolbarButton.1e69d966.js";import"./LeftArrow.d8255c35.js";import"./Wrappers.c2aef7a9.js";const q=()=>{const{isMobile:u,isTablet:w}=M(),{showSnack:f}=y(),{setErrorMessage:g,setSuccessMessage:C}=y(),{dateFilter:d,search:b}=A(),[m,x]=i.exports.useState([]),[v,I]=i.exports.useState(0),T=i.exports.useRef(async(r,c,l)=>{const o=await h.getAllInvoices(r,c,l);if(!o.success)return f(o.message,"error");x(o.payload)}),D=i.exports.useRef(async()=>{const r=await h.getExpiryBusinessCount();if(!r.success)return f(r.message,"error");I(r.payload)}),S=async(r,c)=>{var l;try{const o=await h.downloadInvoice(r);if(o){const E=window.URL.createObjectURL(new Blob([o])),n=document.createElement("a");n.href=E,n.setAttribute("download",`${c}.pdf`),document.body.appendChild(n),n.style.display="none",n.click(),(l=n==null?void 0:n.parentNode)==null||l.removeChild(n),C("Report Downloaded")}else throw new Error("Internal Server Error")}catch(o){g(o.message)}};return i.exports.useEffect(()=>{T.current(d.from,d.to,b)},[b,d]),i.exports.useEffect(()=>{D.current()},[]),s(i.exports.Fragment,{children:[u&&e(F,{title:"Invoices"}),e("div",{className:t.ContentInner,children:s("div",{className:t.InnerWrapper,children:[u&&e(P,{placeholder:"Search Invoice No."}),v>0&&e(H,{noOfBusi:v}),e(L,{elevation:0,className:t.Card,children:s(Y,{className:t.CardContent,children:[w&&e(j,{title:"Invoices",placeholder:"Search Invoice No."}),m.length>0?e("div",{className:t.TableOuter,children:e($,{className:t.TableContainer,children:s(z,{children:[e(G,{children:s(N,{className:t.TableHead,children:[e(a,{component:"th",children:"Date"}),e(a,{component:"th",children:"Inv No."}),e(a,{component:"th",children:"Order No."}),e(a,{component:"th",children:"Amount"}),e(a,{component:"th",children:"Download"})]})}),e(U,{children:m&&m.map(r=>{let c="";r.order_array.forEach(o=>{c+=p(o)+", "});const l=p(r.invoice_number);return e(B,{children:s(N,{children:[e(a,{className:t.OrderDate,children:R(r.created_at).format("D MMM YYYY")}),e(a,{children:p(r.invoice_number)}),e(a,{children:c.replace(/,(?=\s*$)/,"")}),s(a,{className:t.OrderDate,children:[r.currency==="INR"?"\u20B9":"$",O(Number(r.billing_amount.payable_amount))]}),e(a,{children:s(W,{component:"button",underline:"none",className:"report-download",onClick:()=>S(r.id,l),children:[e("img",{src:"/static/images/svg/download.svg",alt:"download"}),e("span",{className:"ms-1",children:"Download"})]})})]})})})})]})})}):s("div",{className:t.NoData,children:["There is no invoice to show for this duration.",e("br",{}),"Try to select a different date range."]})]})})]})})]})},Me=()=>s(i.exports.Fragment,{children:[e(_,{children:e("title",{children:"Invoices"})}),e(k,{children:e(q,{})})]});export{Me as default};
