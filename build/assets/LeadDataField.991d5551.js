import{aj as N,ay as T,r as o,a as r,j as e,V as C,az as x,aA as A,ax as V,u as z,an as P,W,L as X}from"./index.7f82941f.js";import{L as B}from"./LeftArrow.d8255c35.js";import{S as _}from"./Search.21aa4e31.js";import{a as S,F as L,A as q}from"./Form.51dca0ed.js";import{f as G,H as $,d as K,I as U,g as Y,h as Z}from"./Wrappers.c2aef7a9.js";import{S as O,a as H,b as R}from"./Search.d8293799.js";import{b as J,c as Q,d as ee,e as ae,f as te,g as re,C as k,a as se}from"./Card.94b21a7c.js";import{C as ie,a as le,b as oe}from"./Cta.a51de5f7.js";import{p as ne}from"./Position.module.ff7b7fa6.js";import{C as de}from"./PopupBoxes.b055c154.js";import{L as ce}from"./ListItem.f29cbb3e.js";import{a as me,L as pe}from"./ListItemText.e793f45c.js";import{M as he}from"./MoreVert.9bd7ff56.js";import{M as ue}from"./Menu.22af6717.js";import{M as g}from"./MenuItem.50616e83.js";import{C as j}from"./Clear.6f7c24d8.js";import{C as fe,u as Fe,F as I}from"./FormTextField.05f4b970.js";import{F as v}from"./FormIOSSwitch.80e44f95.js";import{A as ye}from"./Autocomplete.8a3fb005.js";import{T as Ce}from"./TextField.bc8832bf.js";import{D as be,a as ge,b as Le,c as De}from"./Drawer.2b52f4ed.js";import{F as we,G as xe}from"./Grid.a7877d24.js";import{a as _e,F as E,c as Se}from"./Style.8807be1a.js";import{D as Ie}from"./Drawer.7d1b4dc8.js";import{D as Ne}from"./Divider.6de19a4b.js";import"./ArrowRight.7cb9a070.js";import"./Card.273c3e06.js";import"./CardContent.f8f32f32.js";import"./List.771b1df1.js";import"./listItemButtonClasses.661acbb5.js";import"./isMuiElement.ea3f4046.js";import"./listItemTextClasses.9956a810.js";import"./dividerClasses.ea04d24b.js";import"./Switch.30da1276.js";import"./SwitchBase.b6bfb054.js";import"./useFormControl.95a504f2.js";import"./useControlled.15b67f87.js";import"./Select.460c2a9d.js";import"./Popper.bc27fe36.js";import"./Chip.0fbe1eb2.js";const Te="zTZ5",ke="-wYE",M={LeadDataFieldItem:Te,OptionMenuPaper:ke},ve={px:{xs:3.75,md:2},"&:hover":{bgcolor:"#edfaff"}},Ee=({display_name:n,field_name:d,field_type:p,id:c})=>{const{setErrorMessage:l,setSuccessMessage:i}=N(),{setEditLeadDataId:h,setShowLeadDataForm:u}=T(),[m,f]=o.exports.useState(null),[D,F]=o.exports.useState(!1),y=()=>{F(!0)},w=()=>{F(!1)},b=s=>{f(s.currentTarget)},a=()=>{f(null)},t=async()=>{try{const s=await x.deleteLeadDataField(c);if(!s.success)throw Error(s.message);i(s.message),setTimeout(()=>window.location.reload(),1e3)}catch(s){l(s.message)}finally{w()}};return r(o.exports.Fragment,{children:[r(ce,{component:"div",sx:ve,children:[e(me,{primary:r("div",{className:"primary-block",children:[e("h2",{className:"list-title",children:n}),e("h2",{className:"type",children:p==="string"?"Text":p})]}),secondary:`[${d}]`,className:M.LeadDataFieldItem}),e(pe,{children:e(C,{onClick:b,children:e(he,{})})})]}),Boolean(m)&&r(ue,{anchorEl:m,open:Boolean(m),onClose:a,keepMounted:!0,MenuListProps:{"aria-labelledby":"Options"},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},classes:{paper:M.OptionMenuPaper},children:[e(g,{onClick:()=>{h(c),u(!0),a()},children:"Edit"}),e(g,{onClick:()=>{y(),a()},children:"Delete"})]}),e(de,{title:"Delete",open:D,setOpen:F,onConfirm:async()=>{await t()},positiveLabel:"Delete",negativeLabel:"Cancel",children:"Are you sure you want to delete?"})]})},Me=({isSearchActive:n,setSearchActive:d})=>{const{setLeadDataFilter:p,setShowLeadDataForm:c}=T();return r(J,{children:[e(Q,{children:e(S,{disableIcon:!0,type:"button",onClick:()=>c(!0),className:"small",children:"New Lead Data Field"})}),r(ee,{children:[!n&&e(ae,{children:e(te,{children:"Lead Data Fields"})}),r(re,{children:[n&&e(O,{children:r(H,{children:[e(C,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:e(_,{})}),e(R,{onChange:({target:{value:l}})=>p(l),placeholder:"Search Field"}),e(C,{onClick:()=>{p(""),d(!n)},sx:{position:"absolute",right:0,top:0},children:e(j,{})})]})}),!n&&e(C,{onClick:()=>d(l=>!l),children:e(_,{})})]})]})]})},Ae=({control:n,defaultValue:d,rules:p,name:c,children:l,setValue:i,...h})=>e(fe,{rules:p,control:n,name:c,render:({field:u})=>e(ye,{multiple:!0,options:d,onChange:(m,f)=>{i(u.name,f)},freeSolo:!0,renderInput:m=>e(Ce,{...m,variant:"filled",label:h.label,sx:h.sx})})}),Be=({open:n,closeDrawer:d})=>{const{setErrorMessage:p,setSuccessMessage:c}=N(),{editLeadDataId:l}=A(),{control:i,handleSubmit:h,watch:u,reset:m,setValue:f}=Fe({defaultValues:{field_type:"",display_name:"",field_name:"",display_in_filter:!1,use_lead_title:!1}}),{field_type:D,display_name:F,field_options:y}=u(),w=async t=>{try{if(l){const s=await x.updateLeadDataField(l,t);if(!s.success)throw Error(s.message);c(s.message),setTimeout(()=>window.location.reload(),1e3)}else{const s=await x.createLeadDataField(t);if(!s.success)throw Error(s.message);c(s.message),setTimeout(()=>window.location.reload(),1e3)}}catch(s){p(s.message)}finally{d()}},b=o.exports.useCallback(()=>f("field_name",F.toLowerCase().replaceAll(" ","_")),[F]),a=o.exports.useCallback(async()=>{try{if(l){const t=await x.getLeadDataField(l);if(!t.success)throw Error(t.message);m({field_type:t.payload.field_type,display_name:t.payload.display_name,field_name:t.payload.field_name,display_in_filter:t.payload.display_in_filter,use_lead_title:t.payload.mark_as_lead_title,field_options:t.payload.field_options?t.payload.field_options:[]})}}catch(t){console.error(t.message)}},[l]);return o.exports.useEffect(()=>{b()},[b]),o.exports.useEffect(()=>{a()},[a]),e(Ie,{anchor:"right",open:n,onClose:(t,s)=>!V(s)&&d(),sx:{zIndex:"modal"},children:r(be,{children:[r(ge,{children:[e(C,{onClick:d,className:"icon-md-button",children:e(B,{})}),e(Le,{children:`${l?"Edit":"Create a"} Data Field`})]}),r(De,{onSubmit:h(w),children:[e(we,{children:r(xe,{children:[e(L,{children:r(I,{select:!0,control:i,label:"Data Field Type",name:"field_type",sx:_e,required:!0,defaultValue:D,children:[e(g,{value:"",disabled:!0,children:"Select Data Field Type"}),e(g,{value:"numeric",children:"Number"}),e(g,{value:"string",children:"Text"}),e(g,{value:"boolean",children:"Boolean"}),e(g,{value:"date",children:"Date"})]})}),e(L,{children:e(I,{control:i,name:"display_name",label:"Display Name",placeholder:"Display Name",required:!0,sx:E})}),e(L,{children:e(I,{control:i,name:"field_name",label:"Field Name",placeholder:"Field Name",required:!0,sx:E})}),e(L,{children:e(Ae,{control:i,setValue:f,defaultValue:y!=null?y:[],name:"field_options",label:"Options",sx:Se})}),e(L,{children:r("div",{className:"d-flex justify-content-between",children:[r("div",{className:"grow",children:[e("h5",{className:"field-title",children:"Display Field in Filters & Analytics?"}),e("small",{className:"field-subtitle",children:"This field will be displayed in filter option and analytics can be drawn on this field."})]}),e(v,{control:i,name:"display_in_filter"})]})}),e(L,{children:r("div",{className:"d-flex justify-content-between",children:[r("div",{className:"grow",children:[e("h5",{className:"field-title",children:"Use as Lead Title"}),e("small",{className:"field-subtitle",children:"If a value is available in the field it will show as the default title instead of the phone number in the Chat section."})]}),e(v,{control:i,name:"use_lead_title"})]})})]})}),e(q,{children:e(S,{type:"submit",children:"Save"})})]})]})})},Oe=()=>{const{isMobile:n,isTablet:d}=z(),{setErrorMessage:p}=N(),[c,l]=o.exports.useState(!0),[i,h]=o.exports.useState(!1),{leadDataFields:u,leadDataFilter:m,showLeadDataForm:f}=A(),{setLeadDataFields:D,setLeadDataFilter:F,setShowLeadDataForm:y,setEditLeadDataId:w}=T(),b=o.exports.useCallback(async()=>{try{const a=await x.getLeadDataFields();if(!a.success)throw Error(a.message);D(a.payload),l(!1)}catch(a){p(a.message)}},[]);return o.exports.useEffect(()=>{b()},[b]),c?e(k,{className:ne.AbsCenter,children:e(P,{height:72,width:72})}):r(o.exports.Fragment,{children:[e(W,{children:e("title",{children:"Lead Data Fields"})}),n&&r(G,{children:[!i&&e(C,{component:X,to:"/business-settings",className:"icon-md-button",children:e(B,{})}),!i&&e($,{children:"Lead Data Fields"}),i&&e(O,{children:r(H,{children:[e(C,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:e(_,{})}),e(R,{onChange:({target:{value:a}})=>F(a),placeholder:"Search Field"}),e(C,{onClick:()=>{F(""),h(!i)},sx:{position:"absolute",right:0,top:0},children:e(j,{})})]})}),!i&&u.length>0&&e(C,{onClick:()=>h(a=>!a),children:e(_,{})})]}),e(K,{children:e(U,{children:!c&&e(k,{elevation:0,children:e(se,{sx:{mx:{xs:-3.75,md:0}},children:u.length===0?r(Y,{children:[e(ie,{children:e(S,{disableIcon:!0,onClick:()=>y(!0),className:"small",children:"New Lead Data Field"})}),e(le,{children:e(oe,{children:"Lead Data Field creates an input field for your user, where the value input by a user can be stored and be later retrieved for different users to draw an analytical comparison or as a future reference."})})]}):r(o.exports.Fragment,{children:[d&&e(Me,{isSearchActive:i,setSearchActive:h}),d&&e(Ne,{}),u.filter(a=>{var t;return(t=a==null?void 0:a.display_name)==null?void 0:t.toLowerCase().includes(m==null?void 0:m.toLowerCase())}).reverse().map((a,t)=>e(Ee,{...a},t))]})})})})}),n&&u.length>0&&e(Z,{children:e(S,{onClick:()=>y(!0),variant:"outlined",color:"primary",disableIcon:!0,children:"New Lead Data Field"})}),e(Be,{open:f,closeDrawer:()=>{w(void 0),y(!1)}})]})},wa=()=>e(o.exports.Fragment,{children:e(Oe,{})});export{wa as default};
