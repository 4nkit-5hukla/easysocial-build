import{al as S,j as e,r as t,a as s,A as C,b as I,u as D,V as L,L as W,W as j}from"./index.0e50089d.js";import{a as B,u as H,R as q,A as G}from"./AuthProvider.e5b431f1.js";import{C as U,a as z}from"./Card.7bedda6c.js";import{C as X}from"./Tags.ca367589.js";import{F as Y,G as J}from"./Grid.146b9954.js";import{i as y,c as K,H as Q,d as Z}from"./Wrappers.34ec9d49.js";import{L as $}from"./LeftArrow.21b3a4cf.js";import{u as O,F as g}from"./FormTextField.c0e3e790.js";import{F as P,A as F,a as b}from"./Form.52a74fc4.js";import{F as x}from"./Style.ced39dc3.js";import"./tslib.es6.61e9e735.js";import"./Card.de383c1e.js";import"./CardContent.14eca7f7.js";import"./toConsumableArray.52b4c8e6.js";import"./MenuItem.2347b4b6.js";import"./List.f68a2eea.js";import"./listItemTextClasses.425e33b6.js";import"./dividerClasses.ce986c4c.js";import"./ListItem.ae8bdac7.js";import"./listItemButtonClasses.e1110cf3.js";import"./isMuiElement.abfbb6fd.js";import"./styled.bc7059ff.js";import"./TextField.c3de8082.js";import"./Select.4f434c76.js";import"./useFormControl.19c227b5.js";import"./Menu.75696a10.js";import"./useControlled.8f6662af.js";import"./ArrowRight.e09ead02.js";const ee=()=>{const{setErrorMessage:a,setSuccessMessage:d}=S(),{control:o,handleSubmit:l,reset:n}=O({defaultValues:{newPassword:"",confirmPassword:""}}),h=async f=>{try{const{newPassword:i,confirmPassword:m}=f;if(i===""||m===""){a("Please enter a valid password");return}if(i!==m){a("Passwords do not match");return}const c=await C.updatePassword({password:i,confirm_password:m});if(c.errors)throw Error(c.errors.pop().message);if(!c.success&&c.message)throw Error(c.message);d("Password changed successfully"),window.location.reload(),n()}catch(i){console.log(i)}};return e(t.exports.Fragment,{children:s(y,{onSubmit:l(h),children:[e(P,{children:e(g,{control:o,type:"password",name:"newPassword",label:"New Password",placeholder:"Enter New Password",required:!0,sx:x})}),e(P,{children:e(g,{control:o,type:"password",name:"confirmPassword",label:"Confirm Password",placeholder:"Enter Confirm Password",required:!0,sx:x})}),e(F,{children:e(b,{type:"submit",children:"Save New Password"})})]})})},re="wWjp",se="Y12k",E={ContentWrapper:re,Textfield_helperText:se},te=a=>{const{OTPverification:d}=a,[o,l]=t.exports.useState(!1),[n,h]=t.exports.useState(0),{setErrorMessage:f,setSuccessMessage:i}=S(),{otpVerification:m,sendOTP:c}=B(),[w,A]=t.exports.useState(""),{auth:v}=H(),T=window,{control:V,handleSubmit:M}=O({defaultValues:{OTP:""}}),N=()=>{T.recaptchaVerifier=new q("captcha-container",{size:"invisible",callback:async function(){const r=await c(w);T.confirmationResult=r},"expired-callback":function(){alert("try again!")}},v)},R=async()=>{try{if(!w)throw Error("Please enter a valid mobile number");const r=await c(w);if(!r.success&&r.message)throw f(r.message),Error(r.message);r.success&&l(!0),i(r.message),r.success&&h(180)}catch(r){console.log(r)}},k=t.exports.useRef(async()=>{try{const r=await C.authUserDetails();if(r.errors)throw Error(r.errors.pop().message);if(!r.success&&r.message)throw Error(r.message);const{mobile_number:p}=r.payload;A(p)}catch(r){console.log(r)}}),_=async r=>{try{const{OTP:p}=r,u=await m(p);if(!u.success&&u.message)throw f(u.message),Error(u.message);i(u.message),d()}catch(p){console.log(p)}};return t.exports.useEffect(()=>{k.current()},[]),t.exports.useEffect(()=>{N()},[]),t.exports.useEffect(()=>{n>0?setTimeout(()=>{h(n-1)},1e3):n===0&&l(!1)},[n]),s(t.exports.Fragment,{children:[s(y,{onSubmit:M(_),children:[s(P,{children:[e(g,{control:V,name:"OTP",label:"OTP",placeholder:"Enter One Time Password",required:!0,sx:x,inputProps:{maxLength:6}}),o&&s("div",{className:E.Textfield_helperText,children:[s("p",{children:["SMS Message sent on ",e("strong",{children:w})]}),e("span",{children:s("p",{children:["Resend OTP in"," ",e("strong",{children:n>0?new Date(n*1e3).toISOString().substring(14,19):"00:00"})," "]})})]})]}),s(F,{children:[e(b,{color:"primary",type:"button",onClick:R,disableIcon:!0,disabled:!!o,children:"Send OTP"}),o&&e(b,{disabled:!o,type:"submit",children:"Validate OTP"})]})]}),e("div",{id:"captcha-container"})]})},oe=()=>{const{selectedBusiness:a}=I(),{isMobile:d}=D(),[o,l]=t.exports.useState(!1);return s(t.exports.Fragment,{children:[d&&s(K,{children:[e(L,{component:W,to:a&&a.default_url?a.default_url:"/engage/chat",className:"icon-md-button",children:e($,{})}),e(Q,{children:"My Profile"})]}),e(Z,{children:e("div",{className:E.ContentWrapper,children:e(U,{elevation:0,children:s(z,{children:[e(X,{children:"Change Password"}),e(Y,{children:s(J,{children:[!o&&e(te,{OTPverification:()=>{l(!0)}}),o&&e(ee,{})]})})]})})})})]})},Re=()=>s(G,{children:[e(j,{children:e("title",{children:"My Profile"})}),e(oe,{})]});export{Re as default};
