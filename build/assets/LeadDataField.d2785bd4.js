import{u as k,A as X,a as M,L as j}from"./LeadDataFieldsProvider.44bd203b.js";import{b as I,r as d,a,j as e,$ as x,an as V,ao as q,ap as P,aq as G,V as v,ar as w,am as $,u as K,W as J,L as U}from"./index.38d3e2dd.js";import{L as H}from"./LeftArrow.79d13e8d.js";import{S as _}from"./Search.eb7289a1.js";import{b as S,A as Q}from"./CommonComponents.4b14a98c.js";import{T as Y,p as Z,q as ee,r as ae,s as te,t as ie,u as B,v as A,w as W,D as re,b as z,H as R,o as le,F as se,G as oe,j as D,l as ne,k as N,L as de,x as ce,c as he,y as me,I as pe,z as ue,f as fe,g as ge,A as xe,B as ye,E as Fe,J as be,K as Ce}from"./LayoutComponents.281bca3c.js";import{L as De}from"./ListItem.5c80c32b.js";import{a as Le,L as we}from"./ListItemText.b12da6d0.js";import{M as _e}from"./MoreVert.6092d02d.js";import{M as Se}from"./Menu.e94f9734.js";import{M as b}from"./MenuItem.e4a73d64.js";import{C as O}from"./Clear.22c6fb00.js";import{C as Te,u as ke,F as T}from"./FormTextField.3be4b1b3.js";import{F as E}from"./FormIOSSwitch.60a3fce3.js";import{T as Ie}from"./TextField.23840b04.js";import{D as ve}from"./Drawer.44479df8.js";import{C as Ne,a as Ee}from"./CardContent.840d963f.js";import{D as Me}from"./Divider.6dae6579.js";import"./Select.68c58a58.js";import"./useFormControl.318bb611.js";import"./isMuiElement.7c1115e8.js";import"./Popper.6620797e.js";import"./Chip.59b969a4.js";import"./styled.9bec237d.js";import"./List.7ef95385.js";import"./listItemButtonClasses.50a58ae2.js";import"./listItemTextClasses.a01ad07e.js";import"./Switch.6aeef662.js";import"./SwitchBase.fc61454b.js";const He=({display_name:o,field_name:n,field_type:h,id:m})=>{const{setErrorMessage:s,setSuccessMessage:l}=I(),{setEditLeadDataId:p,setShowLeadDataForm:u}=k(),[c,f]=d.exports.useState(null),[L,y]=d.exports.useState(!1),g=()=>{y(!0)},C=()=>{y(!1)},F=r=>{f(r.currentTarget)},i=()=>{f(null)},t=async()=>{try{const r=await w.deleteLeadDataField(m);if(!r.success)throw Error(r.message);l(r.message),setTimeout(()=>window.location.reload(),1e3)}catch(r){s(r.message)}finally{C()}};return a(d.exports.Fragment,{children:[a(De,{component:"div",sx:{px:{xs:0,md:2}},children:[e(Le,{primary:a("div",{className:"primary-block",children:[e("h2",{className:"list-title",children:o}),e("h2",{className:"type",children:h==="string"?"Text":h})]}),secondary:`[${n}]`,sx:{"& .primary-block":{alignItems:"center",display:"flex",flexWrap:"wrap",gap:1.25,marginBottom:.75,"& .list-title":{color:"text.primary",fontSize:15,fontWeight:500,lineHeight:"18px"},"& .type":{color:"#767676b3",fontSize:12,fontWeight:400,lineHeight:1,textTransform:"uppercase"}},"& .MuiListItemText-secondary":{color:"text.primary",fontSize:12,maxWidth:290,fontWeight:400,lineHeight:"15px"}}}),e(we,{children:e(x,{onClick:F,children:e(_e,{})})})]}),Boolean(c)&&a(Se,{anchorEl:c,open:Boolean(c),onClose:i,keepMounted:!0,MenuListProps:{"aria-labelledby":"Options"},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPaper-root":{minWidth:120}},children:[e(b,{onClick:()=>{p(m),u(!0),i()},children:"Edit"}),e(b,{onClick:()=>{g(),i()},children:"Delete"})]}),a(V,{open:L,"aria-labelledby":"responsive-dialog-title",children:[e(q,{id:"responsive-dialog-title",children:"Delete"}),e(P,{children:"Are you sure you want to delete?"}),a(G,{children:[e(v,{color:"secondary",onClick:()=>{C()},children:"Cancel"}),e(v,{onClick:async()=>{await t()},autoFocus:!0,children:"Delete"})]})]})]})},Be=({isSearchActive:o,setSearchActive:n})=>{const{setLeadDataFilter:h,setShowLeadDataForm:m}=k();return a(Y,{children:[e(Z,{children:e(S,{disableIcon:!0,type:"button",onClick:()=>m(!0),sx:{py:0,px:.625,height:36,mt:0},children:"New Lead Data Field"})}),a(ee,{children:[!o&&e(ae,{children:e(te,{children:"Lead Data Fields"})}),a(ie,{children:[o&&e(B,{children:a(A,{children:[e(x,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:e(_,{})}),e(W,{onChange:({target:{value:s}})=>h(s),placeholder:"Search Field"}),e(x,{onClick:()=>{h(""),n(!o)},sx:{position:"absolute",right:0,top:0},children:e(O,{})})]})}),!o&&e(x,{onClick:()=>n(s=>!s),children:e(_,{})})]})]})]})},Ae=({control:o,defaultValue:n,rules:h,name:m,children:s,setValue:l,...p})=>e(Te,{rules:h,control:o,name:m,render:({field:u})=>e(X,{multiple:!0,options:n,onChange:(c,f)=>{l(u.name,f)},freeSolo:!0,renderInput:c=>e(Ie,{...c,variant:"filled",label:p.label,sx:p.sx})})}),We=({open:o,closeDrawer:n})=>{const{setErrorMessage:h,setSuccessMessage:m}=I(),{editLeadDataId:s}=M(),{control:l,handleSubmit:p,watch:u,reset:c,setValue:f}=ke({defaultValues:{field_type:"",display_name:"",field_name:"",display_in_filter:!1,use_lead_title:!1}}),{field_type:L,display_name:y,field_options:g}=u(),C=async t=>{try{if(console.log(t),s){const r=await w.updateLeadDataField(s,t);if(!r.success)throw Error(r.message);m(r.message),setTimeout(()=>window.location.reload(),1e3)}else{const r=await w.createLeadDataField(t);if(!r.success)throw Error(r.message);m(r.message),setTimeout(()=>window.location.reload(),1e3)}}catch(r){h(r.message)}finally{n()}},F=d.exports.useCallback(()=>f("field_name",y.toLowerCase().replaceAll(" ","_")),[y]),i=d.exports.useCallback(async()=>{try{if(s){const t=await w.getLeadDataField(s);if(!t.success)throw Error(t.message);c({field_type:t.payload.field_type,display_name:t.payload.display_name,field_name:t.payload.field_name,display_in_filter:t.payload.display_in_filter,use_lead_title:t.payload.mark_as_lead_title,field_options:t.payload.field_options?t.payload.field_options:[]})}}catch(t){console.error(t.message)}},[s]);return d.exports.useEffect(()=>{F()},[F]),d.exports.useEffect(()=>{i()},[i]),e(ve,{anchor:"right",open:o,onClose:(t,r)=>!$(r)&&n(),sx:{zIndex:"modal"},children:a(re,{sx:{width:{xs:"100vw",md:360}},children:[a(z,{children:[e(x,{onClick:n,sx:{width:32,height:32},children:e(H,{})}),e(R,{children:`${s?"Edit":"Create a"} Data Field`})]}),a(le,{onSubmit:p(C),children:[e(se,{children:a(oe,{children:[e(D,{children:a(T,{select:!0,control:l,label:"Data Field Type",name:"field_type",sx:ne,required:!0,defaultValue:L,children:[e(b,{value:"",disabled:!0,children:"Select Data Field Type"}),e(b,{value:"numeric",children:"Number"}),e(b,{value:"string",children:"Text"}),e(b,{value:"boolean",children:"Boolean"}),e(b,{value:"date",children:"Date"})]})}),e(D,{children:e(T,{control:l,name:"display_name",label:"Display Name",placeholder:"Display Name",required:!0,sx:N})}),e(D,{children:e(T,{control:l,name:"field_name",label:"Field Name",placeholder:"Field Name",required:!0,sx:N})}),e(D,{children:e(Ae,{control:l,setValue:f,defaultValue:g!=null?g:[],name:"field_options",label:"Options",sx:de})}),e(D,{children:a("div",{className:"d-flex justify-content-between",children:[a("div",{className:"grow",children:[e("h5",{className:"field-title",children:"Display Field in Filters & Analytics?"}),e("small",{className:"field-subtitle",children:"This field will be displayed in filter option and analytics can be drawn on this field."})]}),e(E,{control:l,name:"display_in_filter"})]})}),e(D,{children:a("div",{className:"d-flex justify-content-between",children:[a("div",{className:"grow",children:[e("h5",{className:"field-title",children:"Use as Lead Title"}),e("small",{className:"field-subtitle",children:"If a value is available in the field it will show as the default title instead of the phone number in the Chat section."})]}),e(E,{control:l,name:"use_lead_title"})]})})]})}),e(Q,{children:e(S,{type:"submit",children:"Save"})})]})]})})},ze=()=>{const{isMobile:o,isTablet:n}=K(),{setErrorMessage:h}=I(),[m,s]=d.exports.useState(!0),[l,p]=d.exports.useState(!1),{leadDataFields:u,leadDataFilter:c,showLeadDataForm:f}=M(),{setLeadDataFields:L,setLeadDataFilter:y,setShowLeadDataForm:g,setEditLeadDataId:C}=k(),F=d.exports.useCallback(async()=>{try{const i=await w.getLeadDataFields();if(!i.success)throw Error(i.message);L(i.payload),s(!1)}catch(i){h(i.message)}},[]);return d.exports.useEffect(()=>{F()},[F]),a(d.exports.Fragment,{children:[e(J,{children:e("title",{children:"Lead Data Fields"})}),o&&a(z,{sx:ce,children:[!l&&e(x,{component:U,to:"/business-settings",sx:{width:32,height:32},children:e(H,{})}),!l&&e(R,{children:"Lead Data Fields"}),l&&e(B,{children:a(A,{children:[e(x,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:e(_,{})}),e(W,{onChange:({target:{value:i}})=>y(i),placeholder:"Search Field"}),e(x,{onClick:()=>{y(""),p(!l)},sx:{position:"absolute",right:0,top:0},children:e(O,{})})]})}),!l&&u.length>0&&e(x,{onClick:()=>p(i=>!i),children:e(_,{})})]}),e(he,{sx:me,children:e(pe,{sx:ue,children:!m&&e(Ne,{elevation:0,sx:fe,children:e(Ee,{sx:ge,children:u.length===0?a(xe,{children:[e(ye,{children:e(S,{disableIcon:!0,onClick:()=>g(!0),sx:{borderRadius:2,boxShadow:"0px 8px 8px rgba(50, 197, 255, 0.1)",fontSize:16,fontWeight:700,height:36,lineHeight:"19px",margin:"auto",textTransform:"capitalize"},children:"New Lead Data Field"})}),e(Fe,{children:e(be,{children:"Lead Data Field creates an input field for your user, where the value input by a user can be stored and be later retrieved for different users to draw an analytical comparison or as a future reference."})})]}):a(d.exports.Fragment,{children:[n&&e(Be,{isSearchActive:l,setSearchActive:p}),n&&e(Me,{}),u.filter(i=>{var t;return(t=i==null?void 0:i.display_name)==null?void 0:t.toLowerCase().includes(c==null?void 0:c.toLowerCase())}).reverse().map((i,t)=>e(He,{...i},t))]})})})})}),o&&u.length>0&&e(Ce,{children:e(S,{onClick:()=>g(!0),variant:"outlined",color:"primary",disableIcon:!0,children:"New Lead Data Field"})}),e(We,{open:f,closeDrawer:()=>{C(void 0),g(!1)}})]})},ua=()=>e(j,{children:e(ze,{})});export{ua as default};
