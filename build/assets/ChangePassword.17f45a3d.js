import{al as S,j as e,r as t,a as s,A as C,u as L,V as W,L as _,W as j}from"./index.df75c103.js";import{a as D,u as H,R as q,A as G}from"./AuthProvider.4f8fd9cb.js";import{C as U,a as B}from"./Card.82febd0e.js";import{C as z}from"./Tags.debf260d.js";import{F as X,G as Y}from"./Grid.08c1bc19.js";import{i as y,c as J,H as K,d as Q}from"./Wrappers.948b5f32.js";import{L as Z}from"./LeftArrow.c862dadb.js";import{u as O,F as g}from"./FormTextField.e61b674f.js";import{F as P,A as F,a as b}from"./Form.16d383d7.js";import{F as x}from"./Style.ced39dc3.js";import"./tslib.es6.61e9e735.js";import"./Card.756b2844.js";import"./CardContent.0ec41bf5.js";import"./toConsumableArray.52b4c8e6.js";import"./MenuItem.74ee2269.js";import"./List.9aca8875.js";import"./listItemTextClasses.41da2c1b.js";import"./dividerClasses.0f2232b0.js";import"./ListItem.7919d102.js";import"./listItemButtonClasses.b6714070.js";import"./isMuiElement.551f16f6.js";import"./styled.3731ec9c.js";import"./TextField.fb9bb265.js";import"./Select.076265ad.js";import"./useFormControl.4cd44c9d.js";import"./Menu.ade2397a.js";import"./useControlled.74b410f2.js";import"./ArrowRight.c8a359b0.js";const $=()=>{const{setErrorMessage:c,setSuccessMessage:l}=S(),{control:o,handleSubmit:u,reset:a}=O({defaultValues:{newPassword:"",confirmPassword:""}}),h=async f=>{try{const{newPassword:n,confirmPassword:d}=f;if(n===""||d===""){c("Please enter a valid password");return}if(n!==d){c("Passwords do not match");return}const i=await C.updatePassword({password:n,confirm_password:d});if(i.errors)throw Error(i.errors.pop().message);if(!i.success&&i.message)throw Error(i.message);l("Password changed successfully"),window.location.reload(),a()}catch(n){console.log(n)}};return e(t.exports.Fragment,{children:s(y,{onSubmit:u(h),children:[e(P,{children:e(g,{control:o,type:"password",name:"newPassword",label:"New Password",placeholder:"Enter New Password",required:!0,sx:x})}),e(P,{children:e(g,{control:o,type:"password",name:"confirmPassword",label:"Confirm Password",placeholder:"Enter Confirm Password",required:!0,sx:x})}),e(F,{children:e(b,{type:"submit",children:"Save New Password"})})]})})},ee="wWjp",re="Y12k",E={ContentWrapper:ee,Textfield_helperText:re},se=c=>{const{OTPverification:l}=c,[o,u]=t.exports.useState(!1),[a,h]=t.exports.useState(0),{setErrorMessage:f,setSuccessMessage:n}=S(),{otpVerification:d,sendOTP:i}=D(),[w,A]=t.exports.useState(""),{auth:v}=H(),T=window,{control:V,handleSubmit:M}=O({defaultValues:{OTP:""}}),N=()=>{T.recaptchaVerifier=new q("captcha-container",{size:"invisible",callback:async function(){const r=await i(w);T.confirmationResult=r},"expired-callback":function(){alert("try again!")}},v)},R=async()=>{try{if(!w)throw Error("Please enter a valid mobile number");const r=await i(w);if(!r.success&&r.message)throw f(r.message),Error(r.message);r.success&&u(!0),n(r.message),r.success&&h(180)}catch(r){console.log(r)}},k=t.exports.useRef(async()=>{try{const r=await C.authUserDetails();if(r.errors)throw Error(r.errors.pop().message);if(!r.success&&r.message)throw Error(r.message);const{mobile_number:m}=r.payload;A(m)}catch(r){console.log(r)}}),I=async r=>{try{const{OTP:m}=r,p=await d(m);if(!p.success&&p.message)throw f(p.message),Error(p.message);n(p.message),l()}catch(m){console.log(m)}};return t.exports.useEffect(()=>{k.current()},[]),t.exports.useEffect(()=>{N()},[]),t.exports.useEffect(()=>{a>0?setTimeout(()=>{h(a-1)},1e3):a===0&&u(!1)},[a]),s(t.exports.Fragment,{children:[s(y,{onSubmit:M(I),children:[s(P,{children:[e(g,{control:V,name:"OTP",label:"OTP",placeholder:"Enter One Time Password",required:!0,sx:x,inputProps:{maxLength:6}}),o&&s("div",{className:E.Textfield_helperText,children:[s("p",{children:["SMS Message sent on ",e("strong",{children:w})]}),e("span",{children:s("p",{children:["Resend OTP in"," ",e("strong",{children:a>0?new Date(a*1e3).toISOString().substring(14,19):"00:00"})," "]})})]})]}),s(F,{children:[e(b,{color:"primary",type:"button",onClick:R,disableIcon:!0,disabled:!!o,children:"Send OTP"}),o&&e(b,{disabled:!o,type:"submit",children:"Validate OTP"})]})]}),e("div",{id:"captcha-container"})]})},te=()=>{const{isMobile:c}=L(),[l,o]=t.exports.useState(!1);return s(t.exports.Fragment,{children:[c&&s(J,{children:[e(W,{component:_,to:"/user/profile",className:"icon-md-button",children:e(Z,{})}),e(K,{children:"My Profile"})]}),e(Q,{children:e("div",{className:E.ContentWrapper,children:e(U,{elevation:0,children:s(B,{children:[e(z,{children:"Change Password"}),e(X,{children:s(Y,{children:[!l&&e(se,{OTPverification:()=>{o(!0)}}),l&&e($,{})]})})]})})})})]})},Ne=()=>s(G,{children:[e(j,{children:e("title",{children:"My Profile"})}),e(te,{})]});export{Ne as default};
