"use strict";(self.webpackChunkeasysocial=self.webpackChunkeasysocial||[]).push([[7390],{3355:function(e,n,t){t.d(n,{I:function(){return s}});var r=t(184),s=function(){return(0,r.jsx)("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"//www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M8 1L2 7L8 13",stroke:"#24272C",strokeWidth:2})})}},7390:function(e,n,t){t.r(n),t.d(n,{default:function(){return Q}});var r=t(4165),s=t(5861),a=t(885),i=t(2791),o=t(6907),c=t(3504),l=t(3400),u=t(7621),d=t(9504),h=t(4721),f=t(9709),x=t(221),p=t(3821),m=t(4094),g=t(9451),b=t(773),Z=t(3355),j=t(5021),v=t(9900),k=t(1918),w=t(7064),y=t(1715),C=t(3786),M=t(5574),L=t(5661),D=t(9157),S=t(7123),E=t(6151),I=t(7235),R=t(184),T=function(e){var n=(0,m.s)(),t=n.setErrorMessage,o=n.setSuccessMessage,c=e.title,u=e.description,d=e.ruleId,h=(0,i.useState)(null),f=(0,a.Z)(h,2),p=f[0],g=f[1],b=(0,i.useState)(!1),Z=(0,a.Z)(b,2),T=Z[0],F=Z[1],_=function(){F(!1)},N=function(){g(null)},O=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Z.deleteLeadDistributionRule(d);case 3:if((n=e.sent).success){e.next=6;break}throw Error(n.message);case 6:o(n.message),setTimeout((function(){return window.location.reload()}),1e3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t(e.t0.message);case 13:return e.prev=13,_(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})));return function(){return e.apply(this,arguments)}}();return(0,R.jsxs)(i.Fragment,{children:[(0,R.jsxs)(j.ZP,{component:"div",sx:{px:{xs:0,md:2}},children:[(0,R.jsx)(v.Z,{primary:(0,R.jsxs)("div",{className:"primary-block",children:[(0,R.jsx)("h2",{className:"list-title",children:c}),(0,R.jsx)(k.Z,{label:u,size:"small",sx:{backgroundColor:"#12B0EE",alignItems:"center",color:"#ffffff",borderRadius:1,height:20,"& .MuiChip-label":{px:.5,fontSize:10,fontWeight:900,lineHeight:"12px"}}})]}),sx:{"& .primary-block":{alignItems:"center",display:"flex",flexWrap:"wrap",gap:1.25,marginBottom:.75,"& .list-title":{color:"text.secondary",fontSize:15,fontWeight:500,lineHeight:"18px"}}}}),(0,R.jsx)(w.Z,{children:(0,R.jsx)(l.Z,{onClick:function(e){g(e.currentTarget)},children:(0,R.jsx)(I.Z,{})})})]}),Boolean(p)&&(0,R.jsx)(y.Z,{anchorEl:p,open:Boolean(p),onClose:N,keepMounted:!0,MenuListProps:{"aria-labelledby":"Options"},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPaper-root":{minWidth:120}},children:(0,R.jsx)(C.Z,{onClick:function(){F(!0),N()},children:"Delete"})}),(0,R.jsxs)(M.Z,{open:T,"aria-labelledby":"responsive-dialog-title",children:[(0,R.jsx)(L.Z,{id:"responsive-dialog-title",children:"Delete"}),(0,R.jsx)(D.Z,{children:"Are you sure you want to delete?"}),(0,R.jsxs)(S.Z,{children:[(0,R.jsx)(E.Z,{color:"secondary",onClick:function(){_()},children:"Cancel"}),(0,R.jsx)(E.Z,{onClick:(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:case"end":return e.stop()}}),e)}))),autoFocus:!0,children:"Delete"})]})]})]})},F=function(){var e=(0,g.O0)().totalLdRules,n=(0,g.Bn)().setShowLdrForm;return(0,R.jsxs)(b.sm,{children:[(0,R.jsx)(b.vd,{children:(0,R.jsx)(b.Kk,{disableIcon:!0,type:"button",onClick:function(){return n(!0)},sx:{py:0,px:.625,height:36,mt:0},children:"New Lead Distribution Rule"})}),(0,R.jsx)(b.DU,{children:(0,R.jsx)(b.yE,{children:(0,R.jsx)(b.og,{children:"".concat(e," Lead Distribution Rules")})})})]})},_=t(2982),N=t(1413),O=t(5987),B=t(3974),V=t(890),q=t(2343),z=t(4280),W=t(3239),P=t(1134),H=t(341),A=t(5641),K=["children"],Y=(0,i.forwardRef)((function(e,n){var t=e.children,r=(0,O.Z)(e,K),s=(0,i.useRef)(null);return(0,i.useImperativeHandle)(n,(function(){return s.current})),(0,R.jsx)("ul",(0,N.Z)((0,N.Z)({},r),{},{ref:s,role:"list-box",children:t}))})),G=function(e){var n=e.open,t=e.closeDrawer,o=(0,m.s)(),c=o.setErrorMessage,u=o.setSuccessMessage,d=(0,g.O0)(),h=d.teamMembers,f=d.leadDataFields,p=d.teamMembersTotal,j=(0,g.Bn)(),v=j.setTeamMembers,k=j.setTeamMembersTotal,w=(0,i.useState)(!1),y=(0,a.Z)(w,2),M=y[0],L=y[1],D=(0,i.useState)(!0),S=(0,a.Z)(D,2),E=S[0],I=S[1],T=(0,i.useState)(""),F=(0,a.Z)(T,2),O=F[0],K=F[1],G=(0,i.useDeferredValue)(O),U=(0,i.useState)(1),Q=(0,a.Z)(U,2),J=Q[0],X=Q[1],$=(0,P.cI)({defaultValues:{param_name:"",rule:{},assign_to:"",param_type:"",logic:"match"}}),ee=$.control,ne=$.handleSubmit,te=$.watch,re=$.setValue,se=te().param_name,ae=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,X(n),e.next=4,x.Z.getTeamMembers(G,n);case 4:if((t=e.sent).success){e.next=7;break}throw Error(t.message);case 7:v([].concat((0,_.Z)(h),(0,_.Z)(t.payload.data))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),c(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n){return e.apply(this,arguments)}}(),ie=(0,i.useCallback)((0,s.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=13;break}return 1,I(!0),X(1),e.next=7,x.Z.getTeamMembers(G,1);case 7:if((t=e.sent).success){e.next=10;break}throw Error(t.message);case 10:v(t.payload.data),k(t.payload.meta.total),I(!1);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),c(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),[n,G]),oe=(0,i.useCallback)((function(){if(""!==se){var e=f.filter((function(e){return e.field_name===se})),n=(0,a.Z)(e,1)[0];n&&re("param_type",n.field_type)}}),[se]),ce=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Z.createLeadDistributionRule(n);case 3:if((s=e.sent).success){e.next=6;break}throw Error(s.message);case 6:u(s.message),setTimeout((function(){return window.location.reload()}),1e3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),c(e.t0.message);case 13:return e.prev=13,setTimeout((function(){return t()}),1e3),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})));return function(n){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){ie()}),[ie]),(0,i.useEffect)((function(){oe()}),[oe]),(0,R.jsx)(B.ZP,{anchor:"right",open:n,onClose:function(e,n){return!(0,H.MF)(n)&&t()},sx:{zIndex:"modal"},children:(0,R.jsxs)(b.Dj,{sx:{width:{xs:"100vw",md:360}},children:[(0,R.jsxs)(b.yW,{children:[(0,R.jsx)(l.Z,{onClick:t,sx:{width:32,height:32},children:(0,R.jsx)(Z.I,{})}),(0,R.jsx)(b.Gh,{children:"Create New Rule"})]}),(0,R.jsxs)(b.aN,{onSubmit:ne(ce),autoComplete:"off",children:[(0,R.jsx)(V.Z,{component:"p",color:"#24272C",fontSize:18,lineHeight:"21px",marginBottom:3,children:"Assign enquiry to team member when lead data field matches value."}),(0,R.jsx)(b.gq,{children:(0,R.jsxs)(b.mn,{children:[(0,R.jsx)(b.gN,{children:(0,R.jsxs)(A.Z,{select:!0,control:ee,label:"Lead Data Field",name:"param_name",sx:b.Br,required:!0,defaultValue:se,children:[0===f.length?(0,R.jsx)(C.Z,{value:"",disabled:!0,children:"No Lead Data Field Available"}):(0,R.jsx)(C.Z,{value:"",disabled:!0,children:"Select Lead Data Field"}),f.map((function(e){var n=e.id,t=e.display_name,r=e.field_name;return(0,R.jsx)(C.Z,{value:r,children:t},n)}))]})}),(0,R.jsx)(b.gN,{children:(0,R.jsx)(A.Z,{control:ee,name:"rule.value",label:"Match Value",placeholder:"Match Value",required:!0,sx:b.ey})}),(0,R.jsx)(b.gN,{children:(0,R.jsx)(q.Z,{open:M,onOpen:function(){L(!0)},onClose:function(){K(""),L(!1)},noOptionsText:"Team Member not found.",isOptionEqualToValue:function(e,n){return e.user.name===n.user.name},getOptionLabel:function(e){return e.user.name},options:h,loading:E,onChange:function(e,n){n&&re("assign_to",n.user.id)},onInputChange:function(e,n){K(n.length>2?n:"")},ListboxComponent:Y,ListboxProps:{onScroll:function(e){var n=e.currentTarget;n.scrollTop+n.clientHeight===n.scrollHeight&&p&&p>h.length&&ae(J+1)}},renderOption:function(e,n){return(0,i.createElement)(C.Z,(0,N.Z)((0,N.Z)({},e),{},{value:n.user.id,key:n.user_id}),n.user.name)},renderInput:function(e){return(0,R.jsx)(z.Z,(0,N.Z)((0,N.Z)({},e),{},{label:"Assign To",required:!0,InputProps:(0,N.Z)((0,N.Z)({},e.InputProps),{},{endAdornment:(0,R.jsxs)(i.Fragment,{children:[E?(0,R.jsx)(W.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})})]})}),(0,R.jsx)(b.W9,{children:(0,R.jsx)(b.Kk,{type:"submit",children:"Save"})})]})]})})},U=function(){var e=(0,p.O)(),n=e.isMobile,t=e.isTablet,j=(0,m.s)().setErrorMessage,v=(0,i.useState)(!0),k=(0,a.Z)(v,2),w=k[0],y=k[1],C=(0,i.useState)(!1),M=(0,a.Z)(C,2),L=M[0],D=M[1],S=(0,i.useState)(1),E=(0,a.Z)(S,2),I=E[0],_=E[1],N=(0,g.O0)(),O=N.leadDistributionRules,B=N.showLdrForm,V=N.totalLdRules,q=(0,g.Bn)(),z=q.setLeadDataFields,W=q.setLeadDistributionRules,P=q.setShowLdrForm,H=q.setTotalLdRules,A=(0,i.useCallback)((0,s.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Z.getLeadDistributionRules(I);case 3:if((n=e.sent).success){e.next=6;break}throw Error(n.message);case 6:W((function(e){return e.concat(n.payload.data)})),0===V&&H(n.payload.meta.total),y(!1),D(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),j(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[I]),K=(0,i.useCallback)((0,s.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Z.getLeadDataFields();case 3:if((n=e.sent).success){e.next=6;break}throw Error(n.message);case 6:z(n.payload),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),j(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),[]);return(0,i.useEffect)((function(){K()}),[K]),(0,i.useEffect)((function(){A()}),[A]),(0,R.jsxs)(i.Fragment,{children:[(0,R.jsx)(o.ql,{children:(0,R.jsx)("title",{children:"Lead Distribution Rules"})}),(0,R.jsxs)(b.VY,{children:[n&&(0,R.jsxs)(b.yW,{sx:b.jo,children:[(0,R.jsx)(l.Z,{component:c.rU,to:"/business-settings",sx:{width:32,height:32},children:(0,R.jsx)(Z.I,{})}),(0,R.jsx)(b.Gh,{children:"Lead Distribution Rules"})]}),(0,R.jsx)(b.hm,{sx:b.q7,children:(0,R.jsx)(b.Ip,{sx:b._e,children:!w&&(0,R.jsx)(u.Z,{elevation:0,sx:b.we,children:(0,R.jsx)(d.Z,{sx:b.ny,children:0===O.length?(0,R.jsxs)(b.rV,{children:[(0,R.jsx)(b._D,{children:(0,R.jsx)(b.Kk,{disableIcon:!0,onClick:function(){return P(!0)},sx:{borderRadius:2,boxShadow:"0px 8px 8px rgba(50, 197, 255, 0.1)",fontSize:16,fontWeight:700,height:36,lineHeight:"19px",margin:"auto",textTransform:"capitalize"},children:"New Lead Distribution Rule"})}),(0,R.jsx)(b.iC,{children:(0,R.jsx)(b.y7,{children:"Create logical rules, based on which an enquiry is automatically assigned to a team member."})})]}):(0,R.jsxs)(i.Fragment,{children:[t&&(0,R.jsx)(F,{}),t&&(0,R.jsx)(h.Z,{}),O.map((function(e,n){var t=e.rule,r=e.user,s=(e.param_name,e.id);return(0,R.jsx)(T,{title:r.name,description:t.value,ruleId:s},n)})),V>O.length&&(0,R.jsx)(b.en,{children:(0,R.jsx)(f.Z,{variant:"contained",color:"primary",onClick:function(){_((function(e){return e+1})),D(!0)},loading:L,children:"Load More"})})]})})})})}),n&&O.length>0&&(0,R.jsx)(b.jB,{children:(0,R.jsx)(b.Kk,{onClick:function(){return P(!0)},variant:"outlined",color:"primary",disableIcon:!0,children:"New Lead Distribution Rule"})})]}),(0,R.jsx)(G,{open:B,closeDrawer:function(){P(!1)}})]})},Q=function(){return(0,R.jsx)(U,{})}},5641:function(e,n,t){var r=t(1413),s=t(5987),a=t(4280),i=t(1134),o=t(184),c=["control","defaultValue","rules","name","children"];n.Z=function(e){var n=e.control,t=(e.defaultValue,e.rules),l=e.name,u=e.children,d=(0,s.Z)(e,c);return(0,o.jsx)(i.Qr,{rules:t,control:n,name:l,render:function(e){var n,t=e.field;return(0,o.jsx)(a.Z,(0,r.Z)((0,r.Z)({},d),{},{value:null!==(n=t.value)&&void 0!==n?n:"",onChange:t.onChange,children:u}))}})}},341:function(e,n,t){t.d(n,{E:function(){return c},MF:function(){return o},bw:function(){return l},mr:function(){return a},pv:function(){return u},qt:function(){return i}});var r=t(2426),s=t.n(r);function a(){for(var e=[],n=0;n<3;n++)e.push(Math.floor(255*Math.random()));return"rgb("+e.join(",")+", 0.5)"}function i(e){e=Number(e);var n=Math.floor(e/3600),t=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(n>0?n+(1===n?" hour ":" hours "):"")+(t>0?t+(1===t?" minute ":" minutes "):"")+(r>0?r+(1===r?" second":" seconds"):"")}var o=function(e){return"backdropClick"===e||"escapeKeyDown"===e},c=function(e){return s()(e).format("MMM YYYY")},l=function(e){var n=[];return e.includes("facebook")&&(n=e.filter((function(e){return"facebook"!==e}))),e.includes("instagram")&&(n=n.filter((function(e){return"instagram"!==e}))),(e.includes("facebook")||e.includes("instagram"))&&n.unshift("facebook and instagram"),e.includes("facebook and instagram")&&!n.includes("facebook and instagram")&&n.push("facebook and instagram"),e.includes("twitter")&&!n.includes("twitter")&&n.push("twitter"),e.includes("linkedin")&&!n.includes("linkedin")&&n.push("linkedin"),n},u=function(e){return{children:"".concat(e.split(" ")[0][0]).concat(e.split(" ")[1][0])}}}}]);
//# sourceMappingURL=7390.28635165.chunk.js.map