"use strict";(self.webpackChunkeasysocial=self.webpackChunkeasysocial||[]).push([[1259],{512:function(e,t,n){n.r(t),n.d(t,{default:function(){return ce}});var r=n(1413),s=n(4165),a=n(5861),o=n(885),i=n(2791),c=n(6907),l=n(3504),u=n(3400),d=n(7621),p=n(9504),x=n(4721),h=n(8940),m=n(221),f=n(1377),g=n(8924),b=n(752),j=n(9862),v=n(113),y=n(5021),Z=n(9900),T=n(1918),w=n(7064),E=n(1715),k=n(3786),C=n(5574),R=n(5661),M=n(9157),S=n(7123),D=n(6151),N=n(7235),I=n(3452),B=n(184),O=function(e){var t=e.template_status,n=e.name,r=e.id,c=e.description,l=(0,b.s)(),d=l.setErrorMessage,p=l.setSuccessMessage,x=(0,f.Bn)(),h=x.setEditWaTemplateId,g=x.setShowWaTemplateForm,j=x.setPreviewWaTemplateId,v=x.setShowWaTemplatePreview,O=(0,i.useState)(null),U=(0,o.Z)(O,2),W=U[0],A=U[1],F=(0,i.useState)(!1),P=(0,o.Z)(F,2),V=P[0],_=P[1],L=function(){_(!1)},H=function(){A(null)},q=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.Z.deleteWaTemplateMessage(r);case 3:if((t=e.sent).success){e.next=6;break}throw Error(t.message);case 6:p(t.message),setTimeout((function(){return window.location.reload()}),1e3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),d(e.t0.message);case 13:return e.prev=13,L(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})));return function(){return e.apply(this,arguments)}}();return(0,B.jsxs)(i.Fragment,{children:[(0,B.jsxs)(y.ZP,{component:"div",sx:{px:{xs:0,md:2}},children:[(0,B.jsx)(Z.Z,{primary:(0,B.jsxs)("div",{className:"primary-block",children:[(0,B.jsx)("h2",{className:"list-title",children:n}),(0,B.jsx)(T.Z,{label:t,size:"small",sx:{bgcolor:I.sB[t],alignItems:"center",color:"#ffffff",borderRadius:1,height:20,"& .MuiChip-label":{px:.5,fontSize:10,fontWeight:900,lineHeight:"12px"}}})]}),secondary:c,sx:{"& .primary-block":{alignItems:"center",display:"flex",flexWrap:"wrap",gap:1.25,marginBottom:.75,"& .list-title":{color:"text.secondary",fontSize:15,fontWeight:500,lineHeight:"18px"}},"& .MuiListItemText-secondary":{color:"text.secondary",fontSize:12,fontWeight:400,lineHeight:"15px"}}}),(0,B.jsx)(w.Z,{children:(0,B.jsx)(u.Z,{onClick:function(e){A(e.currentTarget)},children:(0,B.jsx)(N.Z,{})})})]}),Boolean(W)&&(0,B.jsxs)(E.Z,{anchorEl:W,open:Boolean(W),onClose:H,keepMounted:!0,MenuListProps:{"aria-labelledby":"Options"},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPaper-root":{minWidth:120}},children:["DRAFT"===t&&(0,B.jsx)(k.Z,{onClick:function(){h(r),g(!0),H()},children:"Edit"}),("SUBMITTED"===t||"APPROVED"===t)&&(0,B.jsx)(k.Z,{onClick:function(){j(r),v(!0),H()},children:"Preview"}),(0,B.jsx)(k.Z,{onClick:function(){_(!0),H()},children:"Delete"})]}),(0,B.jsxs)(C.Z,{open:V,"aria-labelledby":"responsive-dialog-title",children:[(0,B.jsx)(R.Z,{id:"responsive-dialog-title",children:"Delete"}),(0,B.jsx)(M.Z,{children:"Are you sure you want to delete?"}),(0,B.jsxs)(S.Z,{children:[(0,B.jsx)(D.Z,{color:"secondary",onClick:function(){L()},children:"Cancel"}),(0,B.jsx)(D.Z,{onClick:(0,a.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:case"end":return e.stop()}}),e)}))),autoFocus:!0,children:"Delete"})]})]})]})},U=function(e){var t=e.isSearchActive,n=e.setSearchActive,r=(0,b.s)(),c=r.setErrorMessage,l=r.setSuccessMessage,d=(0,f.O0)().totalWaTemplates,p=(0,f.Bn)(),x=p.setWatFilter,g=p.setShowWaTemplateForm,y=p.setTotalWaTemplates,Z=p.setWaTemplatesData,T=(0,i.useState)(!1),w=(0,o.Z)(T,2),E=w[0],k=w[1],C=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k(!0),e.next=4,m.Z.syncWaTemplateMessage();case 4:if(!(t=e.sent).success){e.next=16;break}return e.next=8,m.Z.getWaTemplateMessages();case 8:if((n=e.sent).success){e.next=11;break}throw Error(t.message);case 11:y(n.payload.length),Z(n.payload),l(t.message),e.next=17;break;case 16:c(t.message);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),c(e.t0.message);case 22:return e.prev=22,k(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,19,22,25]])})));return function(){return e.apply(this,arguments)}}();return(0,B.jsxs)(j.sm,{children:[(0,B.jsx)(j.vd,{children:(0,B.jsx)(j.Kk,{disableIcon:!0,type:"button",onClick:function(){return g(!0)},sx:{py:0,px:2,height:36,mt:0},children:"New Template Message"})}),(0,B.jsxs)(j.DU,{children:[!t&&(0,B.jsx)(j.yE,{children:(0,B.jsx)(j.og,{children:"".concat(d," Template Messages")})}),(0,B.jsxs)(j.sv,{children:[t&&(0,B.jsx)(j._8,{children:(0,B.jsxs)(j.w2,{children:[(0,B.jsx)(u.Z,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:(0,B.jsx)(v.HN,{})}),(0,B.jsx)(j.Mj,{onChange:function(e){var t=e.target.value;return x(t)},placeholder:"Search Template"}),(0,B.jsx)(u.Z,{onClick:function(){x(""),n(!t)},sx:{position:"absolute",right:0,top:0},children:(0,B.jsx)(h.Z,{})})]})}),!t&&(0,B.jsx)(u.Z,{onClick:function(){return n((function(e){return!e}))},children:(0,B.jsx)(v.HN,{})}),!t&&(0,B.jsx)(j.Kk,{icon:(0,B.jsx)(v.fo,{color:E?"#00000042":"#4D4D4D"}),variant:"outlined",type:"button",disabled:E,onClick:function(){return C()},sx:{alignSelf:"center",borderRadius:4,borderColor:"#0000003b",color:"#000000de",flexDirection:"row-reverse",fontSize:14,fontWeight:400,letterSpacing:"0.02857em",lineHeight:"16px",gap:1,height:30,py:.625,px:1.875,textTransform:"capitalize"},children:E?"Syncing...":"Sync Messages"})]})]})]})},W=n(2982),A=n(3974),F=n(4280),P=n(1134),V=n(341),_=n(3956),L=n(5641),H=n(9585),q=n(6739),z=function(e){var t=e.index,n=e.control,r=e.removeQuickReply;return(0,B.jsxs)(d.Z,{sx:{border:"1px solid rgba(0, 0, 0, 0.12)",borderRadius:4,boxShadow:"0px 0px 20px 1px rgba(0, 0, 0, 0.1)",mb:3,p:2,pb:3},elevation:0,children:[(0,B.jsx)(H.Z,{title:"Quick Reply ".concat(t+1),action:(0,B.jsx)(u.Z,{"aria-label":"Remove Quick Reply ".concat(t+1),onClick:function(){return r(t)},children:(0,B.jsx)(q.Z,{})}),sx:{p:0,"& .MuiCardHeader-title":{fontSize:16,fontWeight:500,lineHeight:"22px"}}}),(0,B.jsx)(j.gN,{sx:{my:2},children:(0,B.jsx)(L.Z,{control:n,name:"components[3].buttons[".concat(t,"].text"),label:"Label",required:!0,sx:j.ey})})]},t)},Y=n(4093),K=function(e){var t=e.index,n=e.type,s=e.url,a=e.phone_number,c=e.waTemplateButtonCtaTypes,l=e.control,p=e.setValue,x=e.removeCallAction,h=(0,g.Og)().country,m=/[{][{]\d{1,3}[}][}]/gm,f=(0,i.useState)(0),b=(0,o.Z)(f,2),v=b[0],y=b[1],Z=(0,i.useCallback)((function(){if(s){var e=s.match(m);e&&e.length>0?y(1):y(0)}}),[s]);return(0,i.useEffect)((function(){Z()}),[Z]),(0,B.jsxs)(d.Z,{sx:{border:"1px solid rgba(0, 0, 0, 0.12)",borderRadius:4,boxShadow:"0px 0px 20px 1px rgba(0, 0, 0, 0.1)",mb:3,p:2,pb:3},elevation:0,children:[(0,B.jsx)(H.Z,{title:"Call to Action ".concat(t+1),action:(0,B.jsx)(u.Z,{"aria-label":"Remove Call to Action ".concat(t+1),onClick:function(){return x(t)},children:(0,B.jsx)(q.Z,{})}),sx:{p:0,"& .MuiCardHeader-title":{fontSize:16,fontWeight:500,lineHeight:"22px"}}}),(0,B.jsx)(j.gN,{sx:{my:2},children:(0,B.jsxs)(L.Z,{select:!0,control:l,label:"Action Type",name:"components[3].buttons[".concat(t,"].type"),sx:j.Br,required:!0,defaultValue:n,children:[(0,B.jsx)(k.Z,{value:"",disabled:!0,children:"Select Action Type"}),c.map((function(e,t){var n=e.value,r=e.name;return(0,B.jsx)(k.Z,{value:n,children:r},t)}))]})}),""!==n&&(0,B.jsx)(j.gN,{sx:{my:2},children:(0,B.jsx)(L.Z,{control:l,name:"components[3].buttons[".concat(t,"].text"),label:"Label",required:!0,sx:j.ey})}),"PHONE_NUMBER"===n&&(0,B.jsx)(j.gN,{sx:{my:2},children:(0,B.jsx)(Y.Kr,{label:"Phone",placeholder:"Phone",required:!0,fullWidth:!0,defaultCountry:h,value:null!==a&&void 0!==a?a:"",onChange:function(e){p("components[3].buttons[".concat(t,"].phone_number"),e.replaceAll(" ",""))},variant:"filled",sx:j.RC})}),"URL"===n&&(0,B.jsxs)(j.gN,{sx:{my:2},children:[(0,B.jsxs)(j.n2,{children:[(0,B.jsx)(L.Z,{control:l,name:"components[3].buttons[".concat(t,"].url"),label:"URL",required:!0,sx:(0,r.Z)((0,r.Z)({},j.ey),{},{pb:2,height:"auto"})}),(0,B.jsx)(j.qD,{size:"small",focusRipple:!1,className:"add-variable",disabled:1===v,onClick:function(){if(1!==v){var e="".concat(s,"{{",1,"}}");p("components[3].buttons[".concat(t,"].url"),e),y(1)}},children:"ADD VARIABLE"})]}),(0,B.jsxs)(j.Dy,{children:[(0,B.jsxs)(j.kV,{children:[s?s.length:0,"/60 Characters"]}),(0,B.jsxs)(j.kV,{children:[v,"/1 Variable"]})]})]})]},t)},G=function(e){var t=e.open,n=e.closeDrawer,r=/[{][{]\d{1,3}[}][}]/gm,c=(0,b.s)(),l=c.setErrorMessage,d=c.setSuccessMessage,p=(0,g.Og)().businessId,x=(0,f.O0)(),h=x.editWaTemplateId,y=x.waTemplatesData,Z=x.waTemplateCategories,T=x.waTemplateLanguages,w=x.waTemplateTypes,E=x.waTemplateHeaderTypes,C=x.waTemplateButtonTypes,R=x.waTemplateButtonCtaTypes,M=(0,f.Bn)(),S=M.setWaTemplatesData,D=M.setShowWaPreviewForm,N=M.setPreviewWaTemplateId,O={name:"",category:"",language:"",template_type:"",businessId:p,components:[{format:"",text:"",type:I.rU.HEADER,active:!1},{text:"",type:I.rU.BODY},{text:"",type:I.rU.FOOTER,active:!1},{buttons:[],type:I.rU.BUTTONS,active:!1}]},U=(0,P.cI)({defaultValues:O}),H=U.control,q=U.handleSubmit,Y=U.watch,G=U.reset,Q=U.setValue,X=Y(),$=X.name,J=X.category,ee=X.language,te=X.template_type,ne=X.components,re=ne.find((function(e){return e.type===I.rU.HEADER})),se=ne.find((function(e){return e.type===I.rU.BODY})),ae=ne.find((function(e){return e.type===I.rU.FOOTER})),oe=ne.find((function(e){return e.type===I.rU.BUTTONS})),ie=(0,i.useState)(0),ce=(0,o.Z)(ie,2),le=ce[0],ue=ce[1],de=(0,i.useState)(""),pe=(0,o.Z)(de,2),xe=pe[0],he=pe[1],me=(0,i.useCallback)((function(){var e=null===$.match(/^[A-Za-z0-9_]+$/g)?$.slice(0,-1):$.replace(/\s/g,"").toLowerCase();Q("name",e)}),[$]),fe=(0,i.useCallback)((function(){var e=re.text.match(r);e&&e.length>0?ue(1):ue(0)}),[re.text]),ge=(0,i.useCallback)((function(){var e=re.text.match(r);null!==e&&0!==e.length?(Q("components[0].text",e.reduce((function(e,t,n){return 0===n?e.replace(t,"{{".concat(n+1,"}}")):e.replace(t,"")}),e.reduce((function(e,t,n){return e.replace(t,"{{".concat(n+1,"}}"))}),re.text))),ue(1)):ue(0)}),[re.text]),be=function(e){var t=oe.buttons;t.splice(e,1),Q("components[3].buttons",t)},je=function(e){var t=oe.buttons;t.splice(e,1),Q("components[3].buttons",t)},ve=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(t){var r,a,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!h){e.next=14;break}return e.next=4,m.Z.updateWaTemplateMessage(h,t);case 4:if((a=e.sent).success){e.next=7;break}throw Error(a.message);case 7:d(a.message),N(null!==(r=a.payload.id)&&void 0!==r?r:h),G(O),n(),D(!0),e.next=25;break;case 14:return e.next=16,m.Z.createWaTemplateMessage(t);case 16:if((o=e.sent).success){e.next=19;break}throw Error(o.message);case 19:d(o.message),S([o.payload].concat((0,W.Z)(y))),N(o.payload.id),G(O),n(),D(!0);case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),l(e.t0.message);case 30:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(t){return e.apply(this,arguments)}}(),ye=(0,i.useCallback)((0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!h){e.next=12;break}return e.next=4,m.Z.getWaTemplateMessage(h);case 4:if((t=e.sent).success){e.next=7;break}throw Error(t.message);case 7:G(t.payload),""!==t.payload.components[0].format&&Q("components[0].active",!0),""!==t.payload.components[2].text&&Q("components[2].active",!0),t.payload.components[3].buttons.length>0&&Q("components[3].active",!0),t.payload.components[3].buttons[0]&&("QUICK_REPLY"===t.payload.components[3].buttons[0].type?he("QUICK_REPLY"):"URL"!==t.payload.components[3].buttons[0].type&&"PHONE_NUMBER"!==t.payload.components[3].buttons[0].type||he("CALL_TO_ACTION"));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),l(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))),[h]);return(0,i.useEffect)((function(){ye()}),[ye]),(0,i.useEffect)((function(){me()}),[me]),(0,i.useEffect)((function(){ge()}),[ge]),(0,i.useEffect)((function(){fe()}),[fe]),(0,B.jsx)(A.ZP,{anchor:"right",open:t,onClose:function(e,t){(0,V.MF)(t)||(G(O),n())},sx:{zIndex:"modal"},children:(0,B.jsxs)(j.Dj,{sx:{width:{xs:"100vw",md:360}},children:[(0,B.jsxs)(j.yW,{children:[(0,B.jsx)(u.Z,{onClick:function(){G(O),n()},sx:{width:32,height:32},children:(0,B.jsx)(v.IT,{})}),(0,B.jsx)(j.Gh,{children:"".concat(h?"Update":"Create New"," Template")})]}),(0,B.jsxs)(j.aN,{onSubmit:q(ve),onReset:function(){G(O),n()},children:[(0,B.jsx)(j.gq,{children:(0,B.jsxs)(j.mn,{children:[(0,B.jsx)(j.gN,{children:(0,B.jsx)(L.Z,{control:H,name:"name",label:"Template Name",placeholder:"Template Name",required:!0,sx:j.ey})}),(0,B.jsx)(j.gN,{children:(0,B.jsxs)(L.Z,{select:!0,control:H,label:"Template Category",name:"category",sx:j.Br,required:!0,defaultValue:J,children:[(0,B.jsx)(k.Z,{value:"",disabled:!0,children:"Select Template Category"}),Z.map((function(e,t){var n=e.value,r=e.name;return(0,B.jsx)(k.Z,{value:n,children:r},t)}))]})}),(0,B.jsx)(j.gN,{children:(0,B.jsxs)(L.Z,{select:!0,control:H,label:"Language",name:"language",sx:j.Br,required:!0,defaultValue:ee,children:[(0,B.jsx)(k.Z,{value:"",disabled:!0,children:"Select Language"}),T.map((function(e,t){var n=e.code,r=e.name;return(0,B.jsx)(k.Z,{value:n,children:r},t)}))]})}),(0,B.jsx)(j.gN,{children:(0,B.jsxs)(L.Z,{select:!0,control:H,label:"Template Type",name:"template_type",sx:j.Br,required:!0,defaultValue:te,children:[(0,B.jsx)(k.Z,{value:"",disabled:!0,children:"Select Template Type"}),w.map((function(e,t){var n=e.value,r=e.label;return(0,B.jsx)(k.Z,{value:n,children:r},t)}))]})}),"media"===te&&(0,B.jsx)(j.gN,{children:(0,B.jsxs)(j.gq,{sx:{justifyContent:"space-between"},children:[(0,B.jsx)(j.mn,{children:(0,B.jsx)(j.m8,{children:"Header"})}),(0,B.jsx)(_.Z,{control:H,name:"components[0].active"})]})}),"media"===te&&re.active&&(0,B.jsx)(j.gN,{children:(0,B.jsxs)(L.Z,{select:!0,control:H,label:"Header Type",name:"components[0].format",sx:j.Br,required:!0,defaultValue:re.format,children:[(0,B.jsx)(k.Z,{value:"",disabled:!0,children:"Select Header Type"}),E.map((function(e,t){var n=e.value,r=e.name;return(0,B.jsx)(k.Z,{value:n,children:r},t)}))]})}),"media"===te&&re.active&&"TEXT"===re.format&&(0,B.jsxs)(j.gN,{children:[(0,B.jsxs)(j.n2,{children:[(0,B.jsx)(L.Z,{control:H,rows:5,multiline:!0,name:"components[0].text",placeholder:"Message",required:!0,inputProps:{maxLength:60},sx:j.FO}),(0,B.jsx)(j.qD,{size:"small",focusRipple:!1,className:"add-variable",disabled:1===le,onClick:function(){if(1!==le){var e="".concat(re.text,"{{",1,"}}");Q("components[0].text",e),ue(1)}},children:"ADD VARIABLE"})]}),(0,B.jsxs)(j.Dy,{children:[(0,B.jsxs)(j.kV,{children:[re.text.length,"/60 Characters"]}),(0,B.jsxs)(j.kV,{children:[le,"/1 Variable"]})]})]}),""!==te&&(0,B.jsx)(j.gN,{children:(0,B.jsx)(j.m8,{children:"Body"})}),""!==te&&(0,B.jsxs)(j.gN,{children:[(0,B.jsxs)(j.n2,{children:[(0,B.jsx)(L.Z,{control:H,rows:5,multiline:!0,name:"components[1].text",placeholder:"Message",required:!0,onBlur:function(){var e=se.text.match(r);null!==e&&0!==e.length&&Q("components[1].text",e.reduce((function(e,t,n){return e.replace(t,"{{".concat(n+1,"}}"))}),se.text))},inputProps:{maxLength:1024},sx:j.FO}),(0,B.jsx)(j.qD,{size:"small",focusRipple:!1,className:"add-variable",onClick:function(){var e=se.text.match(r),t=e&&e.length>0?"".concat(se.text,"{{").concat(e.length+1,"}}"):"".concat(se.text,"{{",1,"}}");Q("components[1].text",t)},children:"ADD VARIABLE"})]}),(0,B.jsx)(j.Dy,{children:(0,B.jsxs)(j.kV,{children:[se.text.length,"/1024 Characters"]})})]}),"media"===te&&(0,B.jsx)(j.gN,{children:(0,B.jsxs)(j.gq,{sx:{justifyContent:"space-between"},children:[(0,B.jsx)(j.mn,{children:(0,B.jsx)(j.m8,{children:"Footer"})}),(0,B.jsx)(_.Z,{control:H,name:"components[2].active"})]})}),"media"===te&&ae.active&&(0,B.jsxs)(j.gN,{children:[(0,B.jsx)(j.n2,{children:(0,B.jsx)(L.Z,{control:H,rows:5,multiline:!0,name:"components[2].text",placeholder:"Message",required:!0,inputProps:{maxLength:60},sx:j.FO})}),(0,B.jsx)(j.Dy,{children:(0,B.jsxs)(j.kV,{children:[ae.text.length,"/60 Characters"]})})]}),"media"===te&&(0,B.jsx)(j.gN,{children:(0,B.jsxs)(j.gq,{sx:{justifyContent:"space-between"},children:[(0,B.jsx)(j.mn,{children:(0,B.jsx)(j.m8,{children:"Buttons"})}),(0,B.jsx)(_.Z,{control:H,name:"components[3].active"})]})}),"media"===te&&oe.active&&(0,B.jsxs)(j.gN,{children:[(0,B.jsxs)(j.gq,{sx:{alignItems:"center",columnGap:2,justifyContent:"space-between",mb:2.5},children:[(0,B.jsx)(j.mn,{children:(0,B.jsxs)(F.Z,{select:!0,label:"Button Type",sx:j.Br,required:!0,value:xe,onChange:function(e){he(e.target.value)},disabled:oe.buttons.length>0,children:[(0,B.jsx)(k.Z,{value:"",disabled:!0,children:"Select Button Type"}),C.map((function(e,t){var n=e.label,r=e.name;return(0,B.jsx)(k.Z,{value:r,children:n},t)}))]})}),(0,B.jsx)(j.aV,{children:(0,B.jsx)(j.Kk,{variant:"outlined",color:"primary",onClick:function(){if(""===xe&&l("Please Select button Type"),"QUICK_REPLY"===xe)if(oe.buttons.length<3){var e=oe.buttons;e.push({type:"QUICK_REPLY",text:""}),Q("components[3].buttons",e)}else l("Limit exceeded");if("CALL_TO_ACTION"===xe)if(oe.buttons.length<2){var t=oe.buttons;t.push({type:"",text:""}),Q("components[3].buttons",t)}else l("Limit exceeded")},disableIcon:!0,children:"Add a Button"})})]}),"media"===te&&oe.active&&oe.buttons.length>0&&(0,B.jsx)(i.Fragment,{children:oe.buttons.map((function(e,t){var n=e.type,r=e.url,s=e.phone_number;return"QUICK_REPLY"===n?(0,B.jsx)(z,{index:t,removeQuickReply:be,control:H},t):(0,B.jsx)(K,{index:t,type:n,url:r,phone_number:s,waTemplateButtonCtaTypes:R,control:H,setValue:Q,removeCallAction:je},t)}))})]})]})}),(0,B.jsxs)(j.W9,{children:[(0,B.jsx)(j.Kk,{type:"reset",variant:"outlined",color:"primary",sx:{height:48},disableIcon:!0,children:"Cancel"}),(0,B.jsx)(j.Kk,{type:"submit",children:"Preview & Save"})]})]})]})})},Q=n(5987),X=n(890),$=n(533),J=n(8461),ee=n(3599),te=n(2169),ne=n(4554),re=n(3540),se=function(e){var t=e.components,n=(0,i.useRef)(null),s=(0,i.useState)(!1),a=(0,o.Z)(s,2),c=a[0],l=a[1],u=(0,i.useState)(!1),d=(0,o.Z)(u,2),p=d[0],x=d[1],h=(0,i.useState)(""),m=(0,o.Z)(h,2),f=m[0],g=m[1],b=t.find((function(e){return e.type===I.rU.HEADER})),y=t.find((function(e){return e.type===I.rU.BODY})),Z=t.find((function(e){return e.type===I.rU.FOOTER})),T=t.find((function(e){return e.type===I.rU.BUTTONS})),w=function(e){if(e){var t=e.example;if(t){var n=t.header_text;return n||[]}return[]}return[]}(b),E=function(e){if(e){var t=e.example;if(t){var n=t.header_handle;return n&&n.length>0?(0,o.Z)(n,1)[0]:""}return""}return""}(b),k=function(e){if(e){var t=e.example;if(t){var n=t.header_files;return n&&n.length>0?(0,o.Z)(n,1)[0]:""}return""}return""}(b),C=function(e){if(e){var t=e.example;if(t){var n=t.body_text;return n||[]}return[]}return[]}(y),R=function(e){return b?e.reduce((function(e,t,n){return t&&""!==t?e.replace("{{".concat(n+1,"}}"),t):e}),b.text):""}(w),M=function(e){return y?e.reduce((function(e,t,n){return t&&""!==t?e.replace("{{".concat(n+1,"}}"),t):e}),y.text):""}(C);return(0,i.useEffect)((function(){n.current&&(n.current.addEventListener("playing",(function(){g("playing")})),n.current.addEventListener("pause",(function(){g("")})),n.current.addEventListener("ended",(function(){g("")})),c?n.current.play():n.current.pause())}),[c]),(0,B.jsxs)(j.oU,{children:[b&&"IMAGE"===b.format&&(0,B.jsx)(j.s_,{children:E&&""!==E&&(0,B.jsx)(te.Z,{component:"img",alt:"header-img",image:E,sx:j.B_})}),b&&"VIDEO"===b.format&&(0,B.jsxs)($.Z,{underline:"none",component:"button",type:"button",onClick:function(){return l(!c)},onMouseEnter:function(){return x(!0)},onMouseLeave:function(){return x(!1)},sx:j.lN,children:[(0,B.jsx)(te.Z,{component:"video",ref:n,className:"video",disablePictureInPicture:!0,sx:(0,r.Z)((0,r.Z)({},j.B_),{},{height:130}),children:E&&""!==E&&(0,B.jsx)("source",{src:E,type:"video/mp4"})}),(0,B.jsxs)(ne.Z,{position:"absolute",display:"flex",children:[""===f&&(0,B.jsx)(v.sh,{}),p&&"playing"===f&&(0,B.jsx)(v.dz,{})]})]}),b&&"DOCUMENT"===b.format&&(0,B.jsx)($.Z,{underline:"none",className:"media-wrapper doc",href:E,target:"_blank",sx:(0,r.Z)((0,r.Z)({},j.lN),{},{backgroundColor:"#F5F5F5",color:"#A1AEB4",fontSize:90,fontWeight:900,lineHeight:"96px"}),children:E&&""!==E?k.split(".").pop().slice(0,4).toUpperCase():""}),b&&"TEXT"===b.format&&(0,B.jsx)(j.z,{children:R}),(0,B.jsx)(j.Ac,{children:(0,re.ZP)(M.replaceAll(/(?:\r\n|\r|\n)/g,"<br />"))}),Z&&""!==Z.text&&(0,B.jsx)(j.HU,{children:Z.text}),T&&T.buttons.length>0&&(0,B.jsx)(j.UE,{children:T.buttons.map((function(e,t){return(0,B.jsx)(i.Fragment,{children:"QUICK_REPLY"===e.type?(0,B.jsx)(D.Z,{variant:"outlined",type:"button",sx:(0,r.Z)((0,r.Z)({},j.ef),{},{color:"#767676",minWidth:"calc(50% - 8px)"}),children:e.text}):"PHONE_NUMBER"===e.type?(0,B.jsx)(D.Z,{href:"tel:".concat(e.phone_number),variant:"outlined",sx:(0,r.Z)((0,r.Z)({},j.ef),{},{color:"#32C5FF",minWidth:"100%"}),children:e.text}):(0,B.jsxs)(D.Z,{href:e.example?e.example.reduce((function(e,t,n){return t&&""!==t?e.replace("{{".concat(n+1,"}}"),t):e}),e.url):"",variant:"outlined",target:"_blank",rel:"noreferrer",sx:(0,r.Z)((0,r.Z)({},j.ef),{},{color:"#32C5FF",minWidth:"100%"}),children:[(0,B.jsx)(v.z9,{}),e.text]})},t)}))})]})},ae=["active"],oe=function(e){var t,n,r,c,l=e.open,d=e.closeDrawer,p=(0,g.Og)(),x=p.isMobile,h=p.isTablet,y=/[{][{]\d{1,3}[}][}]/gm,Z=(0,b.s)(),T=Z.setErrorMessage,w=Z.setSuccessMessage,E=(0,f.O0)(),k=E.previewWaTemplateId,C=E.showWaTemplatePreview,R=(0,f.Bn)(),M=R.setPreviewWaTemplateData,S=R.setEditWaTemplateId,D=R.setShowWaTemplateForm,N=(0,i.useState)([]),O=(0,o.Z)(N,2),U=O[0],W=O[1],F={components:[{format:"",text:"",type:I.rU.HEADER},{text:"",type:I.rU.BODY},{text:"",type:I.rU.FOOTER},{buttons:[],type:I.rU.BUTTONS}]},_=(0,P.cI)({defaultValues:F}),H=_.control,q=_.handleSubmit,z=_.watch,Y=_.setValue,K=z().components,G=K.find((function(e){return e.type===I.rU.HEADER})),te=K.find((function(e){return e.type===I.rU.BODY})),ne=K.find((function(e){return e.type===I.rU.BUTTONS})),re=null===G||void 0===G||null===(t=G.example)||void 0===t||null===(n=t.header_handle)||void 0===n?void 0:n[0],oe=[G&&"TEXT"!==G.format,!(!G||"TEXT"!==G.format||!G.text||""===G.text)&&G.text.includes("{{1}}"),te&&te.text&&""!==te.text&&te.text.includes("{{1}}"),ne&&ne.buttons.length>0&&"URL"===(null===(r=ne.buttons[0])||void 0===r?void 0:r.type)&&(null===(c=ne.buttons[0])||void 0===c?void 0:c.url.includes("{{1}}"))].reduce((function(e,t){return e||t}),!1),ie=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.components.map((function(e){e.active;var t=(0,Q.Z)(e,ae);return"HEADER"===t.type?(delete t.example.header_files,t):t})),!k){e.next=10;break}return e.next=5,m.Z.updateWaTemplateComponents(k,{components:n});case 5:if((r=e.sent).success){e.next=8;break}throw Error(r.message);case 8:w(r.message),d();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),T(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),ce=(0,i.useCallback)((function(){K.length>0&&K.forEach((function(e){var t=e.type,n=e.text;e.buttons;if("BODY"===t){var r=n.match(y);r&&W(r.map((function(e,t){return t+1})))}}))}),[K]),le=(0,i.useCallback)((0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!k){e.next=9;break}return e.next=4,m.Z.getWaTemplateMessage(k);case 4:if((t=e.sent).success){e.next=7;break}throw Error(t.message);case 7:M(t.payload),Y("components",t.payload.components);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),T(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),[k]);return(0,i.useEffect)((function(){le()}),[le]),(0,i.useEffect)((function(){ce()}),[ce]),(0,B.jsxs)(A.ZP,{anchor:"right",open:l,onClose:function(e,t){(0,V.MF)(t)&&!C||d()},sx:{zIndex:"modal","& .MuiPaper-root.MuiDrawer-paper":{flexDirection:"row-reverse"}},children:[(0,B.jsxs)(j.Dj,{sx:{width:{xs:"100vw",md:360}},children:[l&&(0,B.jsxs)(j.yW,{children:[(0,B.jsx)(u.Z,{onClick:function(){d()},sx:{width:32,height:32},children:(0,B.jsx)(v.IT,{})}),(0,B.jsx)(j.Gh,{children:oe&&!C?"Enter Sample Values":"Preview Template"})]}),l&&(0,B.jsxs)(j.aN,{onSubmit:q(ie),children:[(!oe||C||x)&&(0,B.jsx)(se,{components:K}),!C&&G&&("IMAGE"===G.format||"VIDEO"===G.format||"DOCUMENT"===G.format)&&(0,B.jsx)(j.gN,{children:(0,B.jsx)(J.Z,{setValue:Y,control:H,fileTypes:"IMAGE"===G.format?ee.F.IMAGE:"VIDEO"===G.format?ee.F.VIDEO:ee.F.FILE,label:"Drag & Drop ".concat(G.format.charAt(0).toUpperCase()).concat(G.format.slice(1).toLowerCase()),defaultFieldName:"components[0].example.header_handle[0]",fileNameField:"components[0].example.header_files[0]",fileURL:null!==re&&void 0!==re?re:"",width:"100%"})}),!C&&G&&"TEXT"===G.format&&G.text.includes("{{1}}")&&(0,B.jsx)(j.gN,{children:(0,B.jsx)(L.Z,{control:H,name:"components[0].example.header_text[0]",label:"Header Variable 1",placeholder:"Header {{1}}",required:!0,sx:j.ey})}),!C&&U.length>0&&U.map((function(e,t){return(0,B.jsx)(j.gN,{children:(0,B.jsx)(L.Z,{control:H,name:"components[1].example.body_text[".concat(t,"]"),label:"Body Variable ".concat(e),placeholder:"Body ".concat(e),required:!0,sx:j.ey})},"bodyVar{{".concat(e,"}}"))})),!C&&ne&&ne.buttons&&ne.buttons.length>0&&ne.buttons.map((function(e,t){return"URL"===e.type?(0,B.jsx)(j.gN,{children:(0,B.jsx)(L.Z,{control:H,name:"components[3].buttons[".concat(t,"].example[0]"),label:"URL Button ".concat(t+1),placeholder:"Url button ".concat(t+1," variable 1"),required:!0,sx:j.ey})},t):null})),!C&&(0,B.jsx)(j.W9,{children:(0,B.jsx)(j.Kk,{type:"submit",children:"Submit for Approval"})}),!C&&(0,B.jsxs)(j.W9,{sx:{alignItems:"center",justifyContent:"center",gap:.625,my:2},children:[(0,B.jsx)(X.Z,{component:"p",sx:{color:"#686C72",fontSize:14,fontWeight:400,lineHeight:"16px"},children:"Not happy?"}),(0,B.jsx)($.Z,{type:"button",component:"button",variant:"body2",underline:"none",onClick:function(){S(k),D(!0),d()},children:"Continue Editing"})]})]})]}),!C&&l&&oe&&h&&(0,B.jsx)(j.Dj,{sx:{borderRight:"1px solid #24272c1a",py:11.25,px:6.25,width:360},children:(0,B.jsx)(se,{components:K})})]})},ie=function(){var e=(0,g.Og)(),t=e.isMobile,n=e.isTablet,y=(0,b.s)().setErrorMessage,Z=(0,i.useState)(!0),T=(0,o.Z)(Z,2),w=T[0],E=T[1],k=(0,i.useState)(!1),C=(0,o.Z)(k,2),R=C[0],M=C[1],S=(0,f.O0)(),D=S.waTemplatesData,N=S.watFilter,I=S.showWaTemplateForm,W=S.showWaPreviewForm,A=S.showWaTemplatePreview,F=(0,f.Bn)(),P=F.setWaTemplatesData,V=F.setTotalWaTemplates,_=F.setWatFilter,L=F.setShowWaTemplateForm,H=F.setShowWaPreviewForm,q=F.setShowWaTemplatePreview,z=F.setEditWaTemplateId,Y=F.setPreviewWaTemplateId,K=(0,i.useCallback)((0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.Z.getWaTemplateMessages();case 3:if((t=e.sent).success){e.next=6;break}throw Error(t.message);case 6:V(t.payload.length),P(t.payload),E(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),y(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),[]);return(0,i.useEffect)((function(){K()}),[K]),(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)(c.ql,{children:(0,B.jsx)("title",{children:"WhatsApp Template Messages"})}),(0,B.jsxs)(j.VY,{children:[t&&(0,B.jsxs)(j.yW,{sx:j.jo,children:[!R&&(0,B.jsx)(u.Z,{component:l.rU,to:"/business-settings",sx:{width:32,height:32},children:(0,B.jsx)(v.IT,{})}),!R&&(0,B.jsx)(j.Gh,{children:"Template Messages"}),R&&(0,B.jsx)(j._8,{children:(0,B.jsxs)(j.w2,{children:[(0,B.jsx)(u.Z,{disableTouchRipple:!0,disableFocusRipple:!0,disableRipple:!0,sx:{position:"absolute"},children:(0,B.jsx)(v.HN,{})}),(0,B.jsx)(j.Mj,{onChange:function(e){var t=e.target.value;return _(t)},placeholder:"Search Template"}),(0,B.jsx)(u.Z,{onClick:function(){_(""),M(!R)},sx:{position:"absolute",right:0,top:0},children:(0,B.jsx)(h.Z,{})})]})}),!R&&D.length>0&&(0,B.jsx)(u.Z,{onClick:function(){return M((function(e){return!e}))},children:(0,B.jsx)(v.HN,{})})]}),(0,B.jsx)(j.hm,{sx:j.q7,children:(0,B.jsx)(j.Ip,{sx:j._e,children:!w&&(0,B.jsx)(d.Z,{elevation:0,sx:j.we,children:(0,B.jsx)(p.Z,{sx:j.ny,children:0===D.length?(0,B.jsxs)(j.rV,{children:[(0,B.jsx)(j._D,{children:(0,B.jsx)(j.Kk,{disableIcon:!0,onClick:function(){return L(!0)},sx:{borderRadius:2,boxShadow:"0px 8px 8px rgba(50, 197, 255, 0.1)",fontSize:16,fontWeight:700,height:36,lineHeight:"19px",margin:"auto",textTransform:"capitalize"},children:"New Template Message"})}),(0,B.jsx)(j.iC,{children:(0,B.jsxs)(j.y7,{children:["In order to initiate a conversation message your customers. Create a new template message. Send a template message to masses from ",(0,B.jsx)("strong",{children:"Broadcast"})," option in ",(0,B.jsx)("strong",{children:"Engage"})," workspace."]})})]}):(0,B.jsxs)(i.Fragment,{children:[n&&(0,B.jsx)(U,{isSearchActive:R,setSearchActive:M}),n&&(0,B.jsx)(x.Z,{}),D.filter((function(e){var t;return null===e||void 0===e||null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(null===N||void 0===N?void 0:N.toLowerCase())})).map((function(e,t){return(0,B.jsx)(O,(0,r.Z)({},e),t)}))]})})})})}),t&&D.length>0&&(0,B.jsx)(j.jB,{children:(0,B.jsx)(j.Kk,{onClick:function(){return L(!0)},variant:"outlined",color:"primary",disableIcon:!0,children:"New Template Message"})})]}),(0,B.jsx)(G,{open:I,closeDrawer:function(){z(void 0),L(!1)}}),(0,B.jsx)(oe,{open:W||A,closeDrawer:function(){Y(void 0),H(!1),q(!1)}})]})},ce=function(){return(0,B.jsx)(ie,{})}},3956:function(e,t,n){var r=n(1413),s=n(5987),a=n(1134),o=n(1514),i=n(184),c=["control","defaultValue","rules","name"];t.Z=function(e){var t=e.control,n=(e.defaultValue,e.rules),l=e.name,u=(0,s.Z)(e,c);return(0,i.jsx)(a.Qr,{rules:n,control:t,name:l,render:function(e){var t=e.field;return(0,i.jsx)(o.k,(0,r.Z)((0,r.Z)({},u),{},{checked:t.value,onChange:t.onChange}))}})}},1514:function(e,t,n){n.d(t,{k:function(){return i}});var r=n(1413),s=n(9955),a=n(6934),o=n(184),i=(0,a.ZP)((function(e){return(0,o.jsx)(s.Z,(0,r.Z)({focusVisibleClassName:".Mui-focusVisible",disableRipple:!0},e))}))((function(e){var t=e.theme;return{width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:t.palette.primary,opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:t.palette.primary,border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:"light"===t.palette.mode?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:13,backgroundColor:"light"===t.palette.mode?"#E9E9EA":"#39393D",opacity:1,transition:t.transitions.create(["background-color"],{duration:500})}}}))},3452:function(e,t,n){n.d(t,{YU:function(){return l},bo:function(){return c},rU:function(){return r},sB:function(){return a},sw:function(){return u}});var r,s,a,o=n(3144),i=n(5671);!function(e){e.HEADER="HEADER",e.BODY="BODY",e.FOOTER="FOOTER",e.BUTTONS="BUTTONS"}(r||(r={})),function(e){e.APPROVED="APPROVED",e.DRAFT="DRAFT",e.SUBMITTED="SUBMITTED"}(s||(s={})),function(e){e.APPROVED="#25ba00",e.DRAFT="#ffad33",e.SUBMITTED="#04c4ee"}(a||(a={}));var c=(0,o.Z)((function e(t,n,r,s){(0,i.Z)(this,e),this.name=t,this.size=n,this.statusColor=r,this.message=s}));c.TIER1=new c("TIER 1",1,"#FF8719","TIER 1 allows 1000 outgoing messages to be sent in 24hrs. To reach next tier send 1000 messages for consecutive 3 days."),c.TIER2=new c("TIER 2",2,"#32C5FF","TIER 1 allows 1000 outgoing messages to be sent in 24hrs. To reach next tier send 1000 messages for consecutive 3 days."),c.TIER3=new c("TIER 3",3,"#00CD39","TIER 1 allows 1000 outgoing messages to be sent in 24hrs. To reach next tier send 1000 messages for consecutive 3 days.");var l=(0,o.Z)((function e(t,n,r){(0,i.Z)(this,e),this.status=t,this.statusColor=n,this.health=r}));l.GREY=new l("Unable to Connect","#82868B","GREY"),l.RED=new l("Poor","#E02020","RED"),l.ORANGE=new l("Moderate","#FF8719","ORANGE"),l.GREEN=new l("Good","#5ECF70","GREEN");var u=(0,o.Z)((function e(t,n){(0,i.Z)(this,e),this.status=t,this.statusColor=n}));u.NotConnected=new u("not-connected","#E02020"),u.Connected=new u("connected","#5ECF70")},341:function(e,t,n){n.d(t,{E:function(){return c},MF:function(){return i},bw:function(){return l},mr:function(){return a},qt:function(){return o}});var r=n(2426),s=n.n(r);function a(){for(var e=[],t=0;t<3;t++)e.push(Math.floor(255*Math.random()));return"rgb("+e.join(",")+", 0.5)"}function o(e){e=Number(e);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(t>0?t+(1===t?" hour ":" hours "):"")+(n>0?n+(1===n?" minute ":" minutes "):"")+(r>0?r+(1===r?" second":" seconds"):"")}var i=function(e){return"backdropClick"===e||"escapeKeyDown"===e},c=function(e){return s()(e).format("MMM YYYY")},l=function(e){var t=[];return e.includes("facebook")&&(t=e.filter((function(e){return"facebook"!==e}))),e.includes("instagram")&&(t=t.filter((function(e){return"instagram"!==e}))),(e.includes("facebook")||e.includes("instagram"))&&t.unshift("facebook and instagram"),e.includes("facebook and instagram")&&!t.includes("facebook and instagram")&&t.push("facebook and instagram"),e.includes("twitter")&&!t.includes("twitter")&&t.push("twitter"),e.includes("linkedin")&&!t.includes("linkedin")&&t.push("linkedin"),t}}}]);
//# sourceMappingURL=1259.7eec6a6f.chunk.js.map