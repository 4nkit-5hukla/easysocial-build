{"version":3,"sources":["assets/icons/more.svg","Pages/PaymentRenewals/PaymentRenewals.module.css","Pages/PaymentRenewals/PaymentRenewals.js"],"names":["module","exports","connect","state","payments","business","businessOrders","dispatch","fetchBusinessOrders","history","renewalOrderHandler","amount","planId","currentPlanExpiry","businessId","props","useState","activeToggle","setActiveToggle","fetchBusinessOrdersRef","useRef","loadRazorPayCheckout","script","document","createElement","src","getElementsByTagName","appendChild","current","length","useEffect","expiryDate","payment","month","Date","expiry","getMonth","day","getDate","year","getFullYear","UITemplate","i","className","classes","Detail","Payment_Grid_Detail","name","nextOrder","Renew_Btn","onClick","data","sessionStorage","setItem","JSON","stringify","push","Payment_Grid_Amount","toString","replace","Options","Toggler","join","Hide","threeDotImg","alt","PaymentRenewals","e","title","PaymentRenewals_Main","ActiveBusiness","Businesses","find","Status_Title","map","InactiveBusiness"],"mappings":"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","file":"static/js/104.11a96951.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/more.feaafa2d.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"PaymentRenewals\":\"PaymentRenewals_PaymentRenewals__2FTa9\",\"PaymentRenewals_Main\":\"PaymentRenewals_PaymentRenewals_Main__3JDVQ\",\"Detail\":\"PaymentRenewals_Detail__16CZT\",\"Status_Title\":\"PaymentRenewals_Status_Title__1nosb\",\"Payment_Grid_Detail\":\"PaymentRenewals_Payment_Grid_Detail__1qFOT\",\"Payment_Grid_Amount\":\"PaymentRenewals_Payment_Grid_Amount__1Bv1X\",\"Renew_Btn\":\"PaymentRenewals_Renew_Btn__3JTSq\",\"Options\":\"PaymentRenewals_Options__2xP0s\",\"Toggler\":\"PaymentRenewals_Toggler__qeacg\",\"Hide\":\"PaymentRenewals_Hide__3iY0L\",\"ActiveBusiness\":\"PaymentRenewals_ActiveBusiness__3nay-\",\"InactiveBusiness\":\"PaymentRenewals_InactiveBusiness__1hUVa\"};","import classes from \"./PaymentRenewals.module.css\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport CustomButton from \"../../Components/UI/Button/CustomButton\";\r\nimport Modal2 from \"../../Components/UI/Modal2/Modal2\";\r\nimport threeDotImg from \"../../assets/icons/more.svg\";\r\nimport { fetchBusinessOrders, renewalOrderHandler } from \"../../Store/actions\";\r\nimport { connect } from \"react-redux\";\r\n\r\nconst PaymentRenewals = (props) => {\r\n  const [activeToggle, setActiveToggle] = useState(null);\r\n\r\n  const fetchBusinessOrdersRef = useRef(() => {});\r\n\r\n  const loadRazorPayCheckout = useRef(() => {\r\n    let script = document.createElement(\"script\");\r\n    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\r\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\r\n  });\r\n\r\n  fetchBusinessOrdersRef.current = () => {\r\n    return (\r\n      props.payments.length < 1 && props.fetchBusinessOrders(props.history)\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchBusinessOrdersRef.current();\r\n    loadRazorPayCheckout.current();\r\n  }, []);\r\n\r\n  const expiryDate = (payment) => {\r\n    const month = new Date(payment.expiry).getMonth() + 1;\r\n    const day = new Date(payment.expiry).getDate();\r\n    const year = new Date(payment.expiry).getFullYear();\r\n\r\n    return `${day}-${month}-${year}`;\r\n  };\r\n\r\n  const UITemplate = (payment, i) => {\r\n    return (\r\n      <div className={classes.Detail} key={i}>\r\n        <div className={classes.Payment_Grid_Detail}>\r\n          <h1>{payment.name}</h1>\r\n          <p>Expires: {expiryDate(payment)}</p>\r\n          {!payment.nextOrder && (\r\n            <CustomButton\r\n              className={classes.Renew_Btn}\r\n              onClick={() => {\r\n                const data = {\r\n                  planId: payment.planId,\r\n                  businessId: payment.businessId,\r\n                  expiry: payment.expiry,\r\n                };\r\n\r\n                sessionStorage.setItem(\"renewDetail\", JSON.stringify(data));\r\n\r\n                return props.history.push(\r\n                  \"/user/payments/order-renewal/summary\"\r\n                );\r\n              }}\r\n            >\r\n              Renew Now\r\n            </CustomButton>\r\n          )}\r\n        </div>\r\n        <div className={classes.Payment_Grid_Amount}>\r\n          <h1>\r\n            Rs{\" \"}\r\n            {payment.amount\r\n              .toString()\r\n              .replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, \",\")}\r\n            .00\r\n          </h1>\r\n          <p>/month</p>\r\n        </div>\r\n        <div className={classes.Options}>\r\n          <div\r\n            onClick={() => setActiveToggle(null)}\r\n            className={\r\n              activeToggle === i\r\n                ? [classes.Toggler].join(\" \")\r\n                : [classes.Toggler, classes.Hide].join(\" \")\r\n            }\r\n          >\r\n            {/* <p>Remove Account</p> */}\r\n            <p>Payment History</p>\r\n          </div>\r\n          <img\r\n            onClick={() => {\r\n              return activeToggle === null\r\n                ? setActiveToggle(i)\r\n                : setActiveToggle(null);\r\n            }}\r\n            src={threeDotImg}\r\n            alt=\"more\"\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const isInactiveOrder = () =>\r\n    props.payments.length > 0 &&\r\n    props.payments.find((payment) => new Date(payment.expiry) < new Date());\r\n\r\n  const isActiveOrder = () =>\r\n    props.payments.find((payment) => new Date(payment.expiry) > new Date());\r\n\r\n  return (\r\n    <section\r\n      className={classes.PaymentRenewals}\r\n      onClick={(e) => {\r\n        // e.stopPropagation();\r\n\r\n        if (activeToggle !== null) {\r\n          return setActiveToggle(null);\r\n        }\r\n      }}\r\n    >\r\n      <Modal2 title=\"Payment Renewals\" />\r\n\r\n      <main className={classes.PaymentRenewals_Main}>\r\n        <div className={[classes.ActiveBusiness, classes.Businesses].join(\" \")}>\r\n          {isActiveOrder() && (\r\n            <h3 className={classes.Status_Title}>Active Businesses</h3>\r\n          )}\r\n\r\n          {props.payments.length > 0 &&\r\n            props.payments.map((payment, i) => {\r\n              if (new Date(payment.expiry) > new Date()) {\r\n                return UITemplate(payment, i);\r\n              }\r\n\r\n              return false;\r\n            })}\r\n        </div>\r\n        <div\r\n          className={[classes.InactiveBusiness, classes.Businesses].join(\" \")}\r\n        >\r\n          {isInactiveOrder() && (\r\n            <h3 className={classes.Status_Title}>Inactive Businesses</h3>\r\n          )}\r\n\r\n          {props.payments.length > 0 &&\r\n            props.payments.map((payment, i) => {\r\n              if (new Date(payment.expiry) < new Date()) {\r\n                return UITemplate(payment, i);\r\n              }\r\n\r\n              return false;\r\n            })}\r\n        </div>\r\n      </main>\r\n    </section>\r\n  );\r\n};\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    payments: state.business.businessOrders,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    fetchBusinessOrders: (history) => dispatch(fetchBusinessOrders(history)),\r\n    renewalOrderHandler: (amount, planId, currentPlanExpiry, businessId) =>\r\n      dispatch(\r\n        renewalOrderHandler(amount, planId, currentPlanExpiry, businessId)\r\n      ),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PaymentRenewals);\r\n"],"sourceRoot":""}